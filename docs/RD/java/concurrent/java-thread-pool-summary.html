<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.48" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://www.ezfri.com/RD/java/concurrent/java-thread-pool-summary.html"><meta property="og:site_name" content="EzFri"><meta property="og:title" content="Java çº¿ç¨‹æ± è¯¦è§£"><meta property="og:type" content="article"><meta property="og:image" content="https://www.ezfri.com/"><meta property="og:updated_time" content="2022-12-02T13:59:58.000Z"><meta property="og:locale" content="zh-CN"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:alt" content="Java çº¿ç¨‹æ± è¯¦è§£"><meta property="article:tag" content="Javaå¹¶å‘"><meta property="article:modified_time" content="2022-12-02T13:59:58.000Z"><meta name="robots" content="all"><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Expires" content="0"><meta name="keywords" content="JavaåŸºç¡€, å¤šçº¿ç¨‹, JVM, è™šæ‹Ÿæœº, æ•°æ®åº“, MySQL, Spring, Redis, MyBatis, ç³»ç»Ÿè®¾è®¡, åˆ†å¸ƒå¼, RPC, é«˜å¯ç”¨, é«˜å¹¶å‘"><meta name="apple-mobile-web-app-capable" content="yes"><link rel="stylesheet" href="/iconfont/iconfont.css"><title>Java çº¿ç¨‹æ± è¯¦è§£ | EzFri</title><meta name="description" content="EzFriçŸ¥è¯†åº“">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/assets/style.eed630e3.css">
    <link rel="modulepreload" href="/assets/app.55c177dd.js"><link rel="modulepreload" href="/assets/java-thread-pool-summary.html.6530159f.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" href="/assets/java-thread-pool-summary.html.a5326c97.js"><link rel="prefetch" href="/assets/home.html.c3d46956.js"><link rel="prefetch" href="/assets/index.html.b73b40d5.js"><link rel="prefetch" href="/assets/slide.html.194facad.js"><link rel="prefetch" href="/assets/home.html.69b5a2a3.js"><link rel="prefetch" href="/assets/home.html.af75b058.js"><link rel="prefetch" href="/assets/home.html.71b1ca4f.js"><link rel="prefetch" href="/assets/home.html.76346359.js"><link rel="prefetch" href="/assets/interview-ready.html.2e762f9b.js"><link rel="prefetch" href="/assets/interview-recards.html.20f21e29.js"><link rel="prefetch" href="/assets/devops.html.1e03805f.js"><link rel="prefetch" href="/assets/basis.html.abfab2cc.js"><link rel="prefetch" href="/assets/character-set.html.41d6485e.js"><link rel="prefetch" href="/assets/api-gateway.html.36151504.js"><link rel="prefetch" href="/assets/distributed-id.html.957080df.js"><link rel="prefetch" href="/assets/distributed-transaction.html.4d79482e.js"><link rel="prefetch" href="/assets/cluster.html.3a4cd408.js"><link rel="prefetch" href="/assets/disaster-recovery_remote-live.html.cf88d69f.js"><link rel="prefetch" href="/assets/fallback_circuit-breaker.html.2d06c9e3.js"><link rel="prefetch" href="/assets/high-availability-system-design.html.549a70cf.js"><link rel="prefetch" href="/assets/limit-request.html.df37cefa.js"><link rel="prefetch" href="/assets/performance-test.html.711a0cad.js"><link rel="prefetch" href="/assets/timeout-and-retry.html.b70dff28.js"><link rel="prefetch" href="/assets/load-balancing.html.67da77d5.js"><link rel="prefetch" href="/assets/read-and-write-separation-and-library-subtable.html.c44692c7.js"><link rel="prefetch" href="/assets/design-pattern.html.6f20f626.js"><link rel="prefetch" href="/assets/J2EEåŸºç¡€çŸ¥è¯†.html.9dd70d78.js"><link rel="prefetch" href="/assets/schedule-task.html.4ba2373d.js"><link rel="prefetch" href="/assets/system-design-questions.html.b73c4747.js"><link rel="prefetch" href="/assets/10-classical-sorting-algorithms.html.cc46b6e2.js"><link rel="prefetch" href="/assets/linkedlist-algorithm-problems.html.9db6a817.js"><link rel="prefetch" href="/assets/string-algorithm-problems.html.dd5b5a9d.js"><link rel="prefetch" href="/assets/the-sword-refers-to-offer.html.f3f1eb66.js"><link rel="prefetch" href="/assets/bloom-filter.html.fd377e06.js"><link rel="prefetch" href="/assets/graph.html.9eabddcc.js"><link rel="prefetch" href="/assets/heap.html.2d7a5a9b.js"><link rel="prefetch" href="/assets/linear-data-structure.html.d68252fc.js"><link rel="prefetch" href="/assets/red-black-tree.html.d375553a.js"><link rel="prefetch" href="/assets/tree.html.cf9cbaa2.js"><link rel="prefetch" href="/assets/linux-intro.html.7f29d8e5.js"><link rel="prefetch" href="/assets/operating-system-basic-questions-01.html.204f9eed.js"><link rel="prefetch" href="/assets/shell-intro.html.7099ad8b.js"><link rel="prefetch" href="/assets/http_https.html.e4c1e646.js"><link rel="prefetch" href="/assets/http1.0_http1.1.html.78f2ce86.js"><link rel="prefetch" href="/assets/osi_tcp-ip-model.html.2de7eac0.js"><link rel="prefetch" href="/assets/other-network-questions.html.474b82fd.js"><link rel="prefetch" href="/assets/è®¡ç®—æœºç½‘ç»œå†…å®¹æ€»ç»“.html.09f22934.js"><link rel="prefetch" href="/assets/a-thousand-lines-of-mysql-study-notes.html.e15999c6.js"><link rel="prefetch" href="/assets/how-sql-executed-in-mysql.html.366e4db4.js"><link rel="prefetch" href="/assets/index-invalidation-caused-by-implicit-conversion.html.0e509999.js"><link rel="prefetch" href="/assets/innodb-implementation-of-mvcc.html.2862b60c.js"><link rel="prefetch" href="/assets/mysql-high-performance-optimization-specification-recommendations.html.b2474ec2.js"><link rel="prefetch" href="/assets/mysql-index.html.b4f2b724.js"><link rel="prefetch" href="/assets/mysql-logs.html.cb4d4684.js"><link rel="prefetch" href="/assets/mysql-questions-01.html.f09dec84.js"><link rel="prefetch" href="/assets/some-thoughts-on-database-storage-time.html.517f9c8e.js"><link rel="prefetch" href="/assets/transaction-isolation-level.html.ee7b43a8.js"><link rel="prefetch" href="/assets/3-commonly-used-cache-read-and-write-strategies.html.4e61d40d.js"><link rel="prefetch" href="/assets/cache-basics.html.b7b04f9e.js"><link rel="prefetch" href="/assets/redis-cluster.html.6ea71110.js"><link rel="prefetch" href="/assets/redis-memory-fragmentation.html.7785b35c.js"><link rel="prefetch" href="/assets/redis-questions-01.html.8e6b298b.js"><link rel="prefetch" href="/assets/dubbo.html.bb2aa5bb.js"><link rel="prefetch" href="/assets/why-use-rpc.html.d2085c3f.js"><link rel="prefetch" href="/assets/cap_base-theorem.html.aabff7cc.js"><link rel="prefetch" href="/assets/gossip.html.2d4e902b.js"><link rel="prefetch" href="/assets/paxos-algorithm.html.a47bf98e.js"><link rel="prefetch" href="/assets/raft-algorithm.html.14d6c544.js"><link rel="prefetch" href="/assets/kafka-questions-01.html.a17bb8bc.js"><link rel="prefetch" href="/assets/message-queue.html.b5212a15.js"><link rel="prefetch" href="/assets/rabbitmq-intro.html.8b9f74eb.js"><link rel="prefetch" href="/assets/rocketmq-intro.html.6cf01955.js"><link rel="prefetch" href="/assets/rocketmq-questions.html.535053d6.js"><link rel="prefetch" href="/assets/bigdecimal.html.28ab69a8.js"><link rel="prefetch" href="/assets/io.html.873e8200.js"><link rel="prefetch" href="/assets/java-basic-01.html.e27ea2f8.js"><link rel="prefetch" href="/assets/java-basic-02.html.f427c901.js"><link rel="prefetch" href="/assets/java-basic-03.html.d3926693.js"><link rel="prefetch" href="/assets/proxy.html.92ab3050.js"><link rel="prefetch" href="/assets/reflection.html.16b3d66b.js"><link rel="prefetch" href="/assets/serialization.html.dbad4a3a.js"><link rel="prefetch" href="/assets/why-there-only-value-passing-in-java.html.f658b65c.js"><link rel="prefetch" href="/assets/java-collection-precautions-for-use.html.6caa4ae5.js"><link rel="prefetch" href="/assets/java-collection-questions-01.html.26a24dea.js"><link rel="prefetch" href="/assets/java-collection-questions-02.html.43867a2b.js"><link rel="prefetch" href="/assets/aqs.html.95a41fa3.js"><link rel="prefetch" href="/assets/atomic-classes.html.2f10c11f.js"><link rel="prefetch" href="/assets/completablefuture-intro.html.4c97fae1.js"><link rel="prefetch" href="/assets/java-concurrent-collections.html.585fbe4b.js"><link rel="prefetch" href="/assets/java-concurrent-questions-01.html.6210ab74.js"><link rel="prefetch" href="/assets/java-concurrent-questions-02.html.d40cbd56.js"><link rel="prefetch" href="/assets/java-thread-pool-best-practices.html.1b007a54.js"><link rel="prefetch" href="/assets/reentrantlock.html.3b435c70.js"><link rel="prefetch" href="/assets/threadlocal.html.52df7b3b.js"><link rel="prefetch" href="/assets/classloader.html.ef5e778d.js"><link rel="prefetch" href="/assets/java-jvm-questions-01.html.e05c2a8f.js"><link rel="prefetch" href="/assets/jvm-intro.html.a74aca72.js"><link rel="prefetch" href="/assets/jvm-parameters-intro.html.69056348.js"><link rel="prefetch" href="/assets/java10.html.25b31a3d.js"><link rel="prefetch" href="/assets/java11.html.11815e16.js"><link rel="prefetch" href="/assets/java12-13.html.53e9e62e.js"><link rel="prefetch" href="/assets/java14-15.html.fbc231f4.js"><link rel="prefetch" href="/assets/java8-common-new-features.html.cb27fd26.js"><link rel="prefetch" href="/assets/java8-tutorial-translate.html.3bd56699.js"><link rel="prefetch" href="/assets/java9.html.0b5e8022.js"><link rel="prefetch" href="/assets/naming.html.5d93cd63.js"><link rel="prefetch" href="/assets/refactoring.html.9d5d9701.js"><link rel="prefetch" href="/assets/RESTfulAPI.html.47972874.js"><link rel="prefetch" href="/assets/netty.html.d07112f5.js"><link rel="prefetch" href="/assets/advantages_disadvantages-of-jwt.html.cc868daa.js"><link rel="prefetch" href="/assets/basis-of-authority-certification.html.f7a4a7ea.js"><link rel="prefetch" href="/assets/data-desensitization.html.45aebe96.js"><link rel="prefetch" href="/assets/jwt-intro.html.d1668099.js"><link rel="prefetch" href="/assets/sentive-words-filter.html.13060ac4.js"><link rel="prefetch" href="/assets/sso-intro.html.de08967b.js"><link rel="prefetch" href="/assets/md-editor.html.4ce6887e.js"><link rel="prefetch" href="/assets/plugin-tools.html.857276c6.js"><link rel="prefetch" href="/assets/zookeeper-in-action.html.1f29429b.js"><link rel="prefetch" href="/assets/zookeeper-intro.html.5d4503cf.js"><link rel="prefetch" href="/assets/zookeeper-plus.html.a94c7f9f.js"><link rel="prefetch" href="/assets/arraylist-source-code.html.a234e69c.js"><link rel="prefetch" href="/assets/concurrent-hash-map-source-code.html.c8544a8e.js"><link rel="prefetch" href="/assets/hashmap-source-code.html.27eabd8d.js"><link rel="prefetch" href="/assets/page.html.5a76bdd1.js"><link rel="prefetch" href="/assets/page.html.cbabda5c.js"><link rel="prefetch" href="/assets/page.html.40626177.js"><link rel="prefetch" href="/assets/page.html.52073a4a.js"><link rel="prefetch" href="/assets/page.html.0cb78876.js"><link rel="prefetch" href="/assets/mybatis-interview.html.813d2199.js"><link rel="prefetch" href="/assets/spring-boot-auto-assembly-principles.html.eb9783e1.js"><link rel="prefetch" href="/assets/spring-common-annotations.html.a7564ecc.js"><link rel="prefetch" href="/assets/spring-design-patterns-summary.html.22c2bb09.js"><link rel="prefetch" href="/assets/spring-knowledge-and-questions-summary.html.a01d437b.js"><link rel="prefetch" href="/assets/spring-transaction.html.57c87f7b.js"><link rel="prefetch" href="/assets/springcloud-intro.html.18d06837.js"><link rel="prefetch" href="/assets/git-intro.html.9085b2a9.js"><link rel="prefetch" href="/assets/github-tips.html.38846baf.js"><link rel="prefetch" href="/assets/404.html.e0b0a01e.js"><link rel="prefetch" href="/assets/index.html.c1a77ebe.js"><link rel="prefetch" href="/assets/index.html.79779236.js"><link rel="prefetch" href="/assets/index.html.c75bd714.js"><link rel="prefetch" href="/assets/index.html.bd2e2eca.js"><link rel="prefetch" href="/assets/index.html.0500b22a.js"><link rel="prefetch" href="/assets/index.html.e5ef0c99.js"><link rel="prefetch" href="/assets/index.html.7dd53cd7.js"><link rel="prefetch" href="/assets/index.html.b3a29827.js"><link rel="prefetch" href="/assets/index.html.c3bf5ca9.js"><link rel="prefetch" href="/assets/index.html.d5d68b07.js"><link rel="prefetch" href="/assets/index.html.187c41f2.js"><link rel="prefetch" href="/assets/index.html.b3c1f666.js"><link rel="prefetch" href="/assets/index.html.64205451.js"><link rel="prefetch" href="/assets/index.html.45316c81.js"><link rel="prefetch" href="/assets/index.html.2f1e4983.js"><link rel="prefetch" href="/assets/index.html.7805f1d4.js"><link rel="prefetch" href="/assets/index.html.a465a3f6.js"><link rel="prefetch" href="/assets/index.html.629d4310.js"><link rel="prefetch" href="/assets/index.html.439c7396.js"><link rel="prefetch" href="/assets/index.html.25fb4a72.js"><link rel="prefetch" href="/assets/index.html.e8b544a7.js"><link rel="prefetch" href="/assets/index.html.a9ef7b24.js"><link rel="prefetch" href="/assets/index.html.37fc2e83.js"><link rel="prefetch" href="/assets/index.html.a1267f38.js"><link rel="prefetch" href="/assets/index.html.a57a03e9.js"><link rel="prefetch" href="/assets/index.html.de0a1f9c.js"><link rel="prefetch" href="/assets/index.html.7f377eba.js"><link rel="prefetch" href="/assets/index.html.4f49cd3b.js"><link rel="prefetch" href="/assets/index.html.2f1ed682.js"><link rel="prefetch" href="/assets/index.html.9041a696.js"><link rel="prefetch" href="/assets/index.html.0aedeb7e.js"><link rel="prefetch" href="/assets/index.html.4a12d8dc.js"><link rel="prefetch" href="/assets/index.html.0d6cd3bb.js"><link rel="prefetch" href="/assets/index.html.8f506dd4.js"><link rel="prefetch" href="/assets/index.html.412fef02.js"><link rel="prefetch" href="/assets/index.html.425e72c3.js"><link rel="prefetch" href="/assets/index.html.4a4e1b0f.js"><link rel="prefetch" href="/assets/index.html.7a0d4eca.js"><link rel="prefetch" href="/assets/index.html.fb14bb03.js"><link rel="prefetch" href="/assets/index.html.7daab107.js"><link rel="prefetch" href="/assets/home.html.7329e9cd.js"><link rel="prefetch" href="/assets/index.html.f9485566.js"><link rel="prefetch" href="/assets/slide.html.20290aaf.js"><link rel="prefetch" href="/assets/home.html.a5907871.js"><link rel="prefetch" href="/assets/home.html.f227feb7.js"><link rel="prefetch" href="/assets/home.html.b2a8f714.js"><link rel="prefetch" href="/assets/home.html.6c070ad3.js"><link rel="prefetch" href="/assets/interview-ready.html.921fa111.js"><link rel="prefetch" href="/assets/interview-recards.html.c3ffe1ac.js"><link rel="prefetch" href="/assets/devops.html.8e24c4ca.js"><link rel="prefetch" href="/assets/basis.html.f03cd07d.js"><link rel="prefetch" href="/assets/character-set.html.5170280c.js"><link rel="prefetch" href="/assets/api-gateway.html.30080d14.js"><link rel="prefetch" href="/assets/distributed-id.html.4a9bf1bb.js"><link rel="prefetch" href="/assets/distributed-transaction.html.6ba7cce9.js"><link rel="prefetch" href="/assets/cluster.html.bddd4501.js"><link rel="prefetch" href="/assets/disaster-recovery_remote-live.html.a9ce3c60.js"><link rel="prefetch" href="/assets/fallback_circuit-breaker.html.13bec640.js"><link rel="prefetch" href="/assets/high-availability-system-design.html.2d858dfd.js"><link rel="prefetch" href="/assets/limit-request.html.e945e6fa.js"><link rel="prefetch" href="/assets/performance-test.html.13dafef0.js"><link rel="prefetch" href="/assets/timeout-and-retry.html.670be285.js"><link rel="prefetch" href="/assets/load-balancing.html.efb8b5ab.js"><link rel="prefetch" href="/assets/read-and-write-separation-and-library-subtable.html.8ae49c50.js"><link rel="prefetch" href="/assets/design-pattern.html.1ffac4f1.js"><link rel="prefetch" href="/assets/J2EEåŸºç¡€çŸ¥è¯†.html.fa9819da.js"><link rel="prefetch" href="/assets/schedule-task.html.d4fe74ba.js"><link rel="prefetch" href="/assets/system-design-questions.html.a3c40a7e.js"><link rel="prefetch" href="/assets/10-classical-sorting-algorithms.html.262296d9.js"><link rel="prefetch" href="/assets/linkedlist-algorithm-problems.html.3459563a.js"><link rel="prefetch" href="/assets/string-algorithm-problems.html.0ce516e2.js"><link rel="prefetch" href="/assets/the-sword-refers-to-offer.html.e5405c69.js"><link rel="prefetch" href="/assets/bloom-filter.html.5fe3132b.js"><link rel="prefetch" href="/assets/graph.html.7b738787.js"><link rel="prefetch" href="/assets/heap.html.472df672.js"><link rel="prefetch" href="/assets/linear-data-structure.html.e1a64cea.js"><link rel="prefetch" href="/assets/red-black-tree.html.2cf05541.js"><link rel="prefetch" href="/assets/tree.html.5c33e055.js"><link rel="prefetch" href="/assets/linux-intro.html.9afffe42.js"><link rel="prefetch" href="/assets/operating-system-basic-questions-01.html.f059fa25.js"><link rel="prefetch" href="/assets/shell-intro.html.3f4209d8.js"><link rel="prefetch" href="/assets/http_https.html.1e4da6ec.js"><link rel="prefetch" href="/assets/http1.0_http1.1.html.aaceccfb.js"><link rel="prefetch" href="/assets/osi_tcp-ip-model.html.06144592.js"><link rel="prefetch" href="/assets/other-network-questions.html.31c0d2f2.js"><link rel="prefetch" href="/assets/è®¡ç®—æœºç½‘ç»œå†…å®¹æ€»ç»“.html.c1a8d02e.js"><link rel="prefetch" href="/assets/a-thousand-lines-of-mysql-study-notes.html.e7596379.js"><link rel="prefetch" href="/assets/how-sql-executed-in-mysql.html.c6ee425a.js"><link rel="prefetch" href="/assets/index-invalidation-caused-by-implicit-conversion.html.3d9b1722.js"><link rel="prefetch" href="/assets/innodb-implementation-of-mvcc.html.8e4947e3.js"><link rel="prefetch" href="/assets/mysql-high-performance-optimization-specification-recommendations.html.ffe9f182.js"><link rel="prefetch" href="/assets/mysql-index.html.809678c2.js"><link rel="prefetch" href="/assets/mysql-logs.html.9aa4c117.js"><link rel="prefetch" href="/assets/mysql-questions-01.html.44d496ca.js"><link rel="prefetch" href="/assets/some-thoughts-on-database-storage-time.html.27d3c47c.js"><link rel="prefetch" href="/assets/transaction-isolation-level.html.8dea33f1.js"><link rel="prefetch" href="/assets/3-commonly-used-cache-read-and-write-strategies.html.1223310e.js"><link rel="prefetch" href="/assets/cache-basics.html.930db953.js"><link rel="prefetch" href="/assets/redis-cluster.html.cdec0f34.js"><link rel="prefetch" href="/assets/redis-memory-fragmentation.html.9feca6cb.js"><link rel="prefetch" href="/assets/redis-questions-01.html.0334a6b5.js"><link rel="prefetch" href="/assets/dubbo.html.242e6d3f.js"><link rel="prefetch" href="/assets/why-use-rpc.html.e924e78f.js"><link rel="prefetch" href="/assets/cap_base-theorem.html.d21e1830.js"><link rel="prefetch" href="/assets/gossip.html.acf4b9dc.js"><link rel="prefetch" href="/assets/paxos-algorithm.html.eb168d0d.js"><link rel="prefetch" href="/assets/raft-algorithm.html.6f8576a7.js"><link rel="prefetch" href="/assets/kafka-questions-01.html.6b1754c7.js"><link rel="prefetch" href="/assets/message-queue.html.cbe2aa02.js"><link rel="prefetch" href="/assets/rabbitmq-intro.html.2ea915e6.js"><link rel="prefetch" href="/assets/rocketmq-intro.html.003ab469.js"><link rel="prefetch" href="/assets/rocketmq-questions.html.1e17b7ab.js"><link rel="prefetch" href="/assets/bigdecimal.html.b6665f2e.js"><link rel="prefetch" href="/assets/io.html.4814800f.js"><link rel="prefetch" href="/assets/java-basic-01.html.4f350a52.js"><link rel="prefetch" href="/assets/java-basic-02.html.59d6e89b.js"><link rel="prefetch" href="/assets/java-basic-03.html.e93e0db8.js"><link rel="prefetch" href="/assets/proxy.html.4bde0270.js"><link rel="prefetch" href="/assets/reflection.html.b39e0d45.js"><link rel="prefetch" href="/assets/serialization.html.7ec13e8d.js"><link rel="prefetch" href="/assets/why-there-only-value-passing-in-java.html.1c5e195e.js"><link rel="prefetch" href="/assets/java-collection-precautions-for-use.html.efbfbf01.js"><link rel="prefetch" href="/assets/java-collection-questions-01.html.8ba28a7f.js"><link rel="prefetch" href="/assets/java-collection-questions-02.html.1740eec9.js"><link rel="prefetch" href="/assets/aqs.html.b0305817.js"><link rel="prefetch" href="/assets/atomic-classes.html.83d6454b.js"><link rel="prefetch" href="/assets/completablefuture-intro.html.78df8303.js"><link rel="prefetch" href="/assets/java-concurrent-collections.html.4af39dc1.js"><link rel="prefetch" href="/assets/java-concurrent-questions-01.html.d5754262.js"><link rel="prefetch" href="/assets/java-concurrent-questions-02.html.49b4d1cc.js"><link rel="prefetch" href="/assets/java-thread-pool-best-practices.html.8e080499.js"><link rel="prefetch" href="/assets/reentrantlock.html.4934c3e7.js"><link rel="prefetch" href="/assets/threadlocal.html.a39bf314.js"><link rel="prefetch" href="/assets/classloader.html.12636d15.js"><link rel="prefetch" href="/assets/java-jvm-questions-01.html.e91302b6.js"><link rel="prefetch" href="/assets/jvm-intro.html.7d2ced4c.js"><link rel="prefetch" href="/assets/jvm-parameters-intro.html.89812633.js"><link rel="prefetch" href="/assets/java10.html.8bacbb5d.js"><link rel="prefetch" href="/assets/java11.html.33c68f29.js"><link rel="prefetch" href="/assets/java12-13.html.254719f1.js"><link rel="prefetch" href="/assets/java14-15.html.8a3fac51.js"><link rel="prefetch" href="/assets/java8-common-new-features.html.f229eece.js"><link rel="prefetch" href="/assets/java8-tutorial-translate.html.1974bf44.js"><link rel="prefetch" href="/assets/java9.html.37846cb9.js"><link rel="prefetch" href="/assets/naming.html.c1ae96a5.js"><link rel="prefetch" href="/assets/refactoring.html.2f29af4a.js"><link rel="prefetch" href="/assets/RESTfulAPI.html.2ee9fb0c.js"><link rel="prefetch" href="/assets/netty.html.43e5cba2.js"><link rel="prefetch" href="/assets/advantages_disadvantages-of-jwt.html.ed366d2c.js"><link rel="prefetch" href="/assets/basis-of-authority-certification.html.8968783c.js"><link rel="prefetch" href="/assets/data-desensitization.html.998ad7e0.js"><link rel="prefetch" href="/assets/jwt-intro.html.758a6ac4.js"><link rel="prefetch" href="/assets/sentive-words-filter.html.51404f6c.js"><link rel="prefetch" href="/assets/sso-intro.html.d1abfd78.js"><link rel="prefetch" href="/assets/md-editor.html.fc1af739.js"><link rel="prefetch" href="/assets/plugin-tools.html.d55e88da.js"><link rel="prefetch" href="/assets/zookeeper-in-action.html.9f5cef8a.js"><link rel="prefetch" href="/assets/zookeeper-intro.html.324c9d47.js"><link rel="prefetch" href="/assets/zookeeper-plus.html.78bb8063.js"><link rel="prefetch" href="/assets/arraylist-source-code.html.abc8229a.js"><link rel="prefetch" href="/assets/concurrent-hash-map-source-code.html.4e8ec443.js"><link rel="prefetch" href="/assets/hashmap-source-code.html.60db5cfb.js"><link rel="prefetch" href="/assets/page.html.1b025c1d.js"><link rel="prefetch" href="/assets/page.html.9a1fc3ba.js"><link rel="prefetch" href="/assets/page.html.3854bd05.js"><link rel="prefetch" href="/assets/page.html.714fd187.js"><link rel="prefetch" href="/assets/page.html.9ee2692e.js"><link rel="prefetch" href="/assets/mybatis-interview.html.d56848c4.js"><link rel="prefetch" href="/assets/spring-boot-auto-assembly-principles.html.bf0a874b.js"><link rel="prefetch" href="/assets/spring-common-annotations.html.7af299d9.js"><link rel="prefetch" href="/assets/spring-design-patterns-summary.html.97d75253.js"><link rel="prefetch" href="/assets/spring-knowledge-and-questions-summary.html.ed9990be.js"><link rel="prefetch" href="/assets/spring-transaction.html.f2e6c1c4.js"><link rel="prefetch" href="/assets/springcloud-intro.html.4189080c.js"><link rel="prefetch" href="/assets/git-intro.html.3d551291.js"><link rel="prefetch" href="/assets/github-tips.html.22ba7c7a.js"><link rel="prefetch" href="/assets/404.html.47425a42.js"><link rel="prefetch" href="/assets/index.html.bad2cdd0.js"><link rel="prefetch" href="/assets/index.html.82edefb0.js"><link rel="prefetch" href="/assets/index.html.90e00881.js"><link rel="prefetch" href="/assets/index.html.1eb9c6bc.js"><link rel="prefetch" href="/assets/index.html.839446e1.js"><link rel="prefetch" href="/assets/index.html.09b32425.js"><link rel="prefetch" href="/assets/index.html.417c2171.js"><link rel="prefetch" href="/assets/index.html.a080c263.js"><link rel="prefetch" href="/assets/index.html.d4d80d0a.js"><link rel="prefetch" href="/assets/index.html.888bbeb7.js"><link rel="prefetch" href="/assets/index.html.d60a9c4f.js"><link rel="prefetch" href="/assets/index.html.66a0cfa3.js"><link rel="prefetch" href="/assets/index.html.3de82fe8.js"><link rel="prefetch" href="/assets/index.html.e85ea817.js"><link rel="prefetch" href="/assets/index.html.097754b9.js"><link rel="prefetch" href="/assets/index.html.3f437828.js"><link rel="prefetch" href="/assets/index.html.92060f4a.js"><link rel="prefetch" href="/assets/index.html.ee28a03b.js"><link rel="prefetch" href="/assets/index.html.c313a3a8.js"><link rel="prefetch" href="/assets/index.html.1e54da52.js"><link rel="prefetch" href="/assets/index.html.2d86fcee.js"><link rel="prefetch" href="/assets/index.html.a1723e3c.js"><link rel="prefetch" href="/assets/index.html.91d70864.js"><link rel="prefetch" href="/assets/index.html.d183c2ba.js"><link rel="prefetch" href="/assets/index.html.d194b957.js"><link rel="prefetch" href="/assets/index.html.bf1ff87f.js"><link rel="prefetch" href="/assets/index.html.c6f94776.js"><link rel="prefetch" href="/assets/index.html.699f4b9d.js"><link rel="prefetch" href="/assets/index.html.4061f6e0.js"><link rel="prefetch" href="/assets/index.html.3ddd196f.js"><link rel="prefetch" href="/assets/index.html.5e9a7c89.js"><link rel="prefetch" href="/assets/index.html.f78a37bb.js"><link rel="prefetch" href="/assets/index.html.6a49bf7e.js"><link rel="prefetch" href="/assets/index.html.9fccfc1a.js"><link rel="prefetch" href="/assets/index.html.a0254a62.js"><link rel="prefetch" href="/assets/index.html.ed03f552.js"><link rel="prefetch" href="/assets/index.html.406e7a60.js"><link rel="prefetch" href="/assets/index.html.4b01578e.js"><link rel="prefetch" href="/assets/index.html.3093b5e7.js"><link rel="prefetch" href="/assets/index.html.d4b89571.js"><link rel="prefetch" href="/assets/404.bfbbd320.js"><link rel="prefetch" href="/assets/Layout.3af42916.js"><link rel="prefetch" href="/assets/Slide.00317191.js"><link rel="prefetch" href="/assets/Blog.a3506eb9.js"><link rel="prefetch" href="/assets/auto.esm.36809f22.js"><link rel="prefetch" href="/assets/index.daae04bf.js"><link rel="prefetch" href="/assets/index.1842ee54.js"><link rel="prefetch" href="/assets/mermaid.esm.min.d8b76e20.js"><link rel="prefetch" href="/assets/highlight.esm.d982e650.js"><link rel="prefetch" href="/assets/markdown.esm.832a189d.js"><link rel="prefetch" href="/assets/math.esm.a3f84b6f.js"><link rel="prefetch" href="/assets/notes.esm.3c361cb7.js"><link rel="prefetch" href="/assets/reveal.esm.b96f05d8.js"><link rel="prefetch" href="/assets/search.esm.80da4a02.js"><link rel="prefetch" href="/assets/zoom.esm.8514a202.js"><link rel="prefetch" href="/assets/photoswipe.esm.92018b73.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><a href="/" class="brand"><img class="logo" src="/logo.png" alt="EzFri"><!----><span class="site-name hide-in-pad">EzFri</span></a><!----></div><div class="navbar-center"><!----><nav class="nav-links"><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="çŸ¥è¯†åº“"><span class="title"><span class="icon iconfont icon-knowledge" style=""></span>çŸ¥è¯†åº“</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/RD/home.html" class="nav-link" aria-label="åç«¯"><span class="icon iconfont icon-houduankaifa" style=""></span>åç«¯<!----></a></li><li class="dropdown-item"><a href="/FE/home.html" class="nav-link" aria-label="å‰ç«¯"><span class="icon iconfont icon-qianduankaifa" style=""></span>å‰ç«¯<!----></a></li><li class="dropdown-item"><a href="/OP/home.html" class="nav-link" aria-label="è¿ç»´"><span class="icon iconfont icon-yunwei" style=""></span>è¿ç»´<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="/extend/home/" class="nav-link" aria-label="äººç”Ÿå¦‚é…’"><span class="icon iconfont icon-jiushuihongjiuhongjiubei" style=""></span>äººç”Ÿå¦‚é…’<!----></a></div></nav><!----></div><div class="navbar-right"><!----><!----><div class="nav-item"><a class="repo-link" href="https://github.com/heplex/EzfriDocs" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><form class="search-box" role="search"><input type="search" placeholder="Search" autocomplete="off" spellcheck="false" value><!----></form><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable active"><span class="icon iconfont icon-java" style=""></span><span class="title">Java</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-basic" style=""></span><span class="title">åŸºç¡€</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-Collection" style=""></span><span class="title">é›†åˆ</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable active"><span class="icon iconfont icon-threading" style=""></span><span class="title">å¤šçº¿ç¨‹</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/RD/java/concurrent/java-concurrent-questions-01.html" class="nav-link sidebar-link sidebar-page" aria-label="Java å¹¶å‘å¸¸è§çŸ¥è¯†ç‚¹ï¼ˆä¸€ï¼‰"><!---->Java å¹¶å‘å¸¸è§çŸ¥è¯†ç‚¹ï¼ˆä¸€ï¼‰<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/RD/java/concurrent/java-concurrent-questions-02.html" class="nav-link sidebar-link sidebar-page" aria-label="Java å¹¶å‘å¸¸è§çŸ¥è¯†ç‚¹ï¼ˆäºŒï¼‰"><!---->Java å¹¶å‘å¸¸è§çŸ¥è¯†ç‚¹ï¼ˆäºŒï¼‰<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable active"><span class="icon iconfont icon-star" style=""></span><span class="title">é‡è¦çŸ¥è¯†ç‚¹</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="Java çº¿ç¨‹æ± è¯¦è§£"><!---->Java çº¿ç¨‹æ± è¯¦è§£<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#ä¸€-ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä¸€ ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„"><!---->ä¸€ ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#äºŒ-executor-æ¡†æ¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="äºŒ Executor æ¡†æ¶"><!---->äºŒ Executor æ¡†æ¶<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_2-1-ç®€ä»‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.1 ç®€ä»‹"><!---->2.1 ç®€ä»‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_2-2-executor-æ¡†æ¶ç»“æ„-ä¸»è¦ç”±ä¸‰å¤§éƒ¨åˆ†ç»„æˆ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.2 Executor æ¡†æ¶ç»“æ„(ä¸»è¦ç”±ä¸‰å¤§éƒ¨åˆ†ç»„æˆ)"><!---->2.2 Executor æ¡†æ¶ç»“æ„(ä¸»è¦ç”±ä¸‰å¤§éƒ¨åˆ†ç»„æˆ)<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_2-3-executor-æ¡†æ¶çš„ä½¿ç”¨ç¤ºæ„å›¾" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.3 Executor æ¡†æ¶çš„ä½¿ç”¨ç¤ºæ„å›¾"><!---->2.3 Executor æ¡†æ¶çš„ä½¿ç”¨ç¤ºæ„å›¾<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#ä¸‰-é‡è¦-threadpoolexecutor-ç±»ç®€å•ä»‹ç»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä¸‰ (é‡è¦)ThreadPoolExecutor ç±»ç®€å•ä»‹ç»"><!---->ä¸‰ (é‡è¦)ThreadPoolExecutor ç±»ç®€å•ä»‹ç»<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_3-1-threadpoolexecutor-ç±»åˆ†æ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.1 ThreadPoolExecutor ç±»åˆ†æ"><!---->3.1 ThreadPoolExecutor ç±»åˆ†æ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_3-2-æ¨èä½¿ç”¨-threadpoolexecutor-æ„é€ å‡½æ•°åˆ›å»ºçº¿ç¨‹æ± " class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.2 æ¨èä½¿ç”¨ ThreadPoolExecutor æ„é€ å‡½æ•°åˆ›å»ºçº¿ç¨‹æ± "><!---->3.2 æ¨èä½¿ç”¨ ThreadPoolExecutor æ„é€ å‡½æ•°åˆ›å»ºçº¿ç¨‹æ± <!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#å››-threadpoolexecutor-ä½¿ç”¨-åŸç†åˆ†æ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å›› ThreadPoolExecutor ä½¿ç”¨+åŸç†åˆ†æ"><!---->å›› ThreadPoolExecutor ä½¿ç”¨+åŸç†åˆ†æ<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_4-1-ç¤ºä¾‹ä»£ç -runnable-threadpoolexecutor" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.1 ç¤ºä¾‹ä»£ç :Runnable+ThreadPoolExecutor"><!---->4.1 ç¤ºä¾‹ä»£ç :Runnable+ThreadPoolExecutor<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_4-2-çº¿ç¨‹æ± åŸç†åˆ†æ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.2 çº¿ç¨‹æ± åŸç†åˆ†æ"><!---->4.2 çº¿ç¨‹æ± åŸç†åˆ†æ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_4-3-å‡ ä¸ªå¸¸è§çš„å¯¹æ¯”" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.3 å‡ ä¸ªå¸¸è§çš„å¯¹æ¯”"><!---->4.3 å‡ ä¸ªå¸¸è§çš„å¯¹æ¯”<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_4-4-åŠ é¤-callable-threadpoolexecutorç¤ºä¾‹ä»£ç " class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.4 åŠ é¤:Callable+ThreadPoolExecutorç¤ºä¾‹ä»£ç "><!---->4.4 åŠ é¤:Callable+ThreadPoolExecutorç¤ºä¾‹ä»£ç <!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#äº”-å‡ ç§å¸¸è§çš„çº¿ç¨‹æ± è¯¦è§£" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="äº” å‡ ç§å¸¸è§çš„çº¿ç¨‹æ± è¯¦è§£"><!---->äº” å‡ ç§å¸¸è§çš„çº¿ç¨‹æ± è¯¦è§£<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_5-1-fixedthreadpool" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.1 FixedThreadPool"><!---->5.1 FixedThreadPool<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_5-2-singlethreadexecutor-è¯¦è§£" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.2 SingleThreadExecutor è¯¦è§£"><!---->5.2 SingleThreadExecutor è¯¦è§£<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_5-3-cachedthreadpool-è¯¦è§£" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.3 CachedThreadPool è¯¦è§£"><!---->5.3 CachedThreadPool è¯¦è§£<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#å…­-scheduledthreadpoolexecutor-è¯¦è§£" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å…­ ScheduledThreadPoolExecutor è¯¦è§£"><!---->å…­ ScheduledThreadPoolExecutor è¯¦è§£<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_6-1-ç®€ä»‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6.1 ç®€ä»‹"><!---->6.1 ç®€ä»‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_6-2-è¿è¡Œæœºåˆ¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6.2 è¿è¡Œæœºåˆ¶"><!---->6.2 è¿è¡Œæœºåˆ¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_6-3-scheduledthreadpoolexecutor-æ‰§è¡Œå‘¨æœŸä»»åŠ¡çš„æ­¥éª¤" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6.3 ScheduledThreadPoolExecutor æ‰§è¡Œå‘¨æœŸä»»åŠ¡çš„æ­¥éª¤"><!---->6.3 ScheduledThreadPoolExecutor æ‰§è¡Œå‘¨æœŸä»»åŠ¡çš„æ­¥éª¤<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#ä¸ƒ-çº¿ç¨‹æ± å¤§å°ç¡®å®š" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä¸ƒ çº¿ç¨‹æ± å¤§å°ç¡®å®š"><!---->ä¸ƒ çº¿ç¨‹æ± å¤§å°ç¡®å®š<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#å…«-å‚è€ƒ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å…« å‚è€ƒ"><!---->å…« å‚è€ƒ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#ä¹-å…¶ä»–æ¨èé˜…è¯»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ä¹ å…¶ä»–æ¨èé˜…è¯»"><!---->ä¹ å…¶ä»–æ¨èé˜…è¯»<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/RD/java/concurrent/java-thread-pool-best-practices.html" class="nav-link sidebar-link sidebar-page" aria-label="Java çº¿ç¨‹æ± æœ€ä½³å®è·µ"><!---->Java çº¿ç¨‹æ± æœ€ä½³å®è·µ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/RD/java/concurrent/java-concurrent-collections.html" class="nav-link sidebar-link sidebar-page" aria-label="Java å¸¸è§å¹¶å‘å®¹å™¨æ€»ç»“"><!---->Java å¸¸è§å¹¶å‘å®¹å™¨æ€»ç»“<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/RD/java/concurrent/aqs.html" class="nav-link sidebar-link sidebar-page" aria-label="AQS åŸç†ä»¥åŠ AQS åŒæ­¥ç»„ä»¶æ€»ç»“"><!---->AQS åŸç†ä»¥åŠ AQS åŒæ­¥ç»„ä»¶æ€»ç»“<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/RD/java/concurrent/reentrantlock.html" class="nav-link sidebar-link sidebar-page" aria-label="ä»ReentrantLockçš„å®ç°çœ‹AQSçš„åŸç†åŠåº”ç”¨"><!---->ä»ReentrantLockçš„å®ç°çœ‹AQSçš„åŸç†åŠåº”ç”¨<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/RD/java/concurrent/atomic-classes.html" class="nav-link sidebar-link sidebar-page" aria-label="Atomic åŸå­ç±»æ€»ç»“"><!---->Atomic åŸå­ç±»æ€»ç»“<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/RD/java/concurrent/threadlocal.html" class="nav-link sidebar-link sidebar-page" aria-label="ä¸‡å­—è§£æ ThreadLocal å…³é”®å­—"><!---->ä¸‡å­—è§£æ ThreadLocal å…³é”®å­—<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/RD/java/concurrent/completablefuture-intro.html" class="nav-link sidebar-link sidebar-page" aria-label="CompletableFutureå…¥é—¨"><!---->CompletableFutureå…¥é—¨<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li></ul></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-jvm" style=""></span><span class="title">è™šæ‹Ÿæœº</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-new" style=""></span><span class="title">æ–°ç‰¹æ€§</span><span class="arrow right"></span></button><!----></section><!--]--></li></ul></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-computer" style=""></span><span class="title">è®¡ç®—æœºåŸºç¡€</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-database" style=""></span><span class="title">æ•°æ®åº“</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-framework" style=""></span><span class="title">å¸¸ç”¨æ¡†æ¶</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-xitongsheji" style=""></span><span class="title">ç³»ç»Ÿè®¾è®¡</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-fenbushi" style=""></span><span class="title">åˆ†å¸ƒå¼</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-et-performance" style=""></span><span class="title">é«˜æ€§èƒ½</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-highavailable" style=""></span><span class="title">é«˜å¯ç”¨</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-tool" style=""></span><span class="title">å·¥å…·</span><span class="arrow right"></span></button><!----></section><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->Java çº¿ç¨‹æ± è¯¦è§£</h1><div class="page-info"><span class="author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down" localizeddate="2022å¹´12æœˆ2æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="https://www.ezfri.com" target="_blank" rel="noopener noreferrer">EzFri</a></span><span property="author" content="EzFri"></span></span><!----><span class="date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>2022å¹´12æœˆ2æ—¥</span><meta property="datePublished" content="2022-12-02T13:59:58.000Z"></span><span class="category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="down" localizeddate="2022å¹´12æœˆ2æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><ul class="categories-wrapper"><li class="category category4 clickable" role="navigation">Java</li><meta property="articleSection" content="Java"></ul></span><span aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="down" localizeddate="2022å¹´12æœˆ2æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><ul class="tags-wrapper"><li class="tag tag8 clickable" role="navigation">Javaå¹¶å‘</li></ul><meta property="keywords" content="Javaå¹¶å‘"></span><span class="reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down" localizeddate="2022å¹´12æœˆ2æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 30 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT30M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">æ­¤é¡µå†…å®¹</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#ä¸€-ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„" class="router-link-active router-link-exact-active toc-link level2">ä¸€ ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#äºŒ-executor-æ¡†æ¶" class="router-link-active router-link-exact-active toc-link level2">äºŒ Executor æ¡†æ¶</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_2-1-ç®€ä»‹" class="router-link-active router-link-exact-active toc-link level3">2.1 ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_2-2-executor-æ¡†æ¶ç»“æ„-ä¸»è¦ç”±ä¸‰å¤§éƒ¨åˆ†ç»„æˆ" class="router-link-active router-link-exact-active toc-link level3">2.2 Executor æ¡†æ¶ç»“æ„(ä¸»è¦ç”±ä¸‰å¤§éƒ¨åˆ†ç»„æˆ)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_2-3-executor-æ¡†æ¶çš„ä½¿ç”¨ç¤ºæ„å›¾" class="router-link-active router-link-exact-active toc-link level3">2.3 Executor æ¡†æ¶çš„ä½¿ç”¨ç¤ºæ„å›¾</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#ä¸‰-é‡è¦-threadpoolexecutor-ç±»ç®€å•ä»‹ç»" class="router-link-active router-link-exact-active toc-link level2">ä¸‰ (é‡è¦)ThreadPoolExecutor ç±»ç®€å•ä»‹ç»</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_3-1-threadpoolexecutor-ç±»åˆ†æ" class="router-link-active router-link-exact-active toc-link level3">3.1 ThreadPoolExecutor ç±»åˆ†æ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_3-2-æ¨èä½¿ç”¨-threadpoolexecutor-æ„é€ å‡½æ•°åˆ›å»ºçº¿ç¨‹æ± " class="router-link-active router-link-exact-active toc-link level3">3.2 æ¨èä½¿ç”¨ ThreadPoolExecutor æ„é€ å‡½æ•°åˆ›å»ºçº¿ç¨‹æ± </a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#å››-threadpoolexecutor-ä½¿ç”¨-åŸç†åˆ†æ" class="router-link-active router-link-exact-active toc-link level2">å›› ThreadPoolExecutor ä½¿ç”¨+åŸç†åˆ†æ</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_4-1-ç¤ºä¾‹ä»£ç -runnable-threadpoolexecutor" class="router-link-active router-link-exact-active toc-link level3">4.1 ç¤ºä¾‹ä»£ç :Runnable+ThreadPoolExecutor</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_4-2-çº¿ç¨‹æ± åŸç†åˆ†æ" class="router-link-active router-link-exact-active toc-link level3">4.2 çº¿ç¨‹æ± åŸç†åˆ†æ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_4-3-å‡ ä¸ªå¸¸è§çš„å¯¹æ¯”" class="router-link-active router-link-exact-active toc-link level3">4.3 å‡ ä¸ªå¸¸è§çš„å¯¹æ¯”</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_4-4-åŠ é¤-callable-threadpoolexecutorç¤ºä¾‹ä»£ç " class="router-link-active router-link-exact-active toc-link level3">4.4 åŠ é¤:Callable+ThreadPoolExecutorç¤ºä¾‹ä»£ç </a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#äº”-å‡ ç§å¸¸è§çš„çº¿ç¨‹æ± è¯¦è§£" class="router-link-active router-link-exact-active toc-link level2">äº” å‡ ç§å¸¸è§çš„çº¿ç¨‹æ± è¯¦è§£</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_5-1-fixedthreadpool" class="router-link-active router-link-exact-active toc-link level3">5.1 FixedThreadPool</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_5-2-singlethreadexecutor-è¯¦è§£" class="router-link-active router-link-exact-active toc-link level3">5.2 SingleThreadExecutor è¯¦è§£</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_5-3-cachedthreadpool-è¯¦è§£" class="router-link-active router-link-exact-active toc-link level3">5.3 CachedThreadPool è¯¦è§£</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#å…­-scheduledthreadpoolexecutor-è¯¦è§£" class="router-link-active router-link-exact-active toc-link level2">å…­ ScheduledThreadPoolExecutor è¯¦è§£</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_6-1-ç®€ä»‹" class="router-link-active router-link-exact-active toc-link level3">6.1 ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_6-2-è¿è¡Œæœºåˆ¶" class="router-link-active router-link-exact-active toc-link level3">6.2 è¿è¡Œæœºåˆ¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#_6-3-scheduledthreadpoolexecutor-æ‰§è¡Œå‘¨æœŸä»»åŠ¡çš„æ­¥éª¤" class="router-link-active router-link-exact-active toc-link level3">6.3 ScheduledThreadPoolExecutor æ‰§è¡Œå‘¨æœŸä»»åŠ¡çš„æ­¥éª¤</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#ä¸ƒ-çº¿ç¨‹æ± å¤§å°ç¡®å®š" class="router-link-active router-link-exact-active toc-link level2">ä¸ƒ çº¿ç¨‹æ± å¤§å°ç¡®å®š</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#å…«-å‚è€ƒ" class="router-link-active router-link-exact-active toc-link level2">å…« å‚è€ƒ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/RD/java/concurrent/java-thread-pool-summary.html#ä¹-å…¶ä»–æ¨èé˜…è¯»" class="router-link-active router-link-exact-active toc-link level2">ä¹ å…¶ä»–æ¨èé˜…è¯»</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h2 id="ä¸€-ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„" tabindex="-1"><a class="header-anchor" href="#ä¸€-ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„" aria-hidden="true">#</a> ä¸€ ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„</h2><blockquote><p><strong>æ± åŒ–æŠ€æœ¯æƒ³å¿…å¤§å®¶å·²ç»å±¡è§ä¸é²œäº†ï¼Œçº¿ç¨‹æ± ã€æ•°æ®åº“è¿æ¥æ± ã€Http è¿æ¥æ± ç­‰ç­‰éƒ½æ˜¯å¯¹è¿™ä¸ªæ€æƒ³çš„åº”ç”¨ã€‚æ± åŒ–æŠ€æœ¯çš„æ€æƒ³ä¸»è¦æ˜¯ä¸ºäº†å‡å°‘æ¯æ¬¡è·å–èµ„æºçš„æ¶ˆè€—ï¼Œæé«˜å¯¹èµ„æºçš„åˆ©ç”¨ç‡ã€‚</strong></p></blockquote><p><strong>çº¿ç¨‹æ± </strong>æä¾›äº†ä¸€ç§é™åˆ¶å’Œç®¡ç†èµ„æºï¼ˆåŒ…æ‹¬æ‰§è¡Œä¸€ä¸ªä»»åŠ¡ï¼‰çš„æ–¹å¼ã€‚ æ¯ä¸ª<strong>çº¿ç¨‹æ± </strong>è¿˜ç»´æŠ¤ä¸€äº›åŸºæœ¬ç»Ÿè®¡ä¿¡æ¯ï¼Œä¾‹å¦‚å·²å®Œæˆä»»åŠ¡çš„æ•°é‡ã€‚</p><p>è¿™é‡Œå€Ÿç”¨ã€ŠJava å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹æåˆ°çš„æ¥è¯´ä¸€ä¸‹<strong>ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„</strong>ï¼š</p><ul><li><strong>é™ä½èµ„æºæ¶ˆè€—</strong>ã€‚é€šè¿‡é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹é™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æ¶ˆè€—ã€‚</li><li><strong>æé«˜å“åº”é€Ÿåº¦</strong>ã€‚å½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œã€‚</li><li><strong>æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§</strong>ã€‚çº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œå¦‚æœæ— é™åˆ¶çš„åˆ›å»ºï¼Œä¸ä»…ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œè¿˜ä¼šé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€çš„åˆ†é…ï¼Œè°ƒä¼˜å’Œç›‘æ§ã€‚</li></ul><h2 id="äºŒ-executor-æ¡†æ¶" tabindex="-1"><a class="header-anchor" href="#äºŒ-executor-æ¡†æ¶" aria-hidden="true">#</a> äºŒ Executor æ¡†æ¶</h2><h3 id="_2-1-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#_2-1-ç®€ä»‹" aria-hidden="true">#</a> 2.1 ç®€ä»‹</h3><p><code>Executor</code> æ¡†æ¶æ˜¯ Java5 ä¹‹åå¼•è¿›çš„ï¼Œåœ¨ Java 5 ä¹‹åï¼Œé€šè¿‡ <code>Executor</code> æ¥å¯åŠ¨çº¿ç¨‹æ¯”ä½¿ç”¨ <code>Thread</code> çš„ <code>start</code> æ–¹æ³•æ›´å¥½ï¼Œé™¤äº†æ›´æ˜“ç®¡ç†ï¼Œæ•ˆç‡æ›´å¥½ï¼ˆç”¨çº¿ç¨‹æ± å®ç°ï¼ŒèŠ‚çº¦å¼€é”€ï¼‰å¤–ï¼Œè¿˜æœ‰å…³é”®çš„ä¸€ç‚¹ï¼šæœ‰åŠ©äºé¿å… this é€ƒé€¸é—®é¢˜ã€‚</p><blockquote><p>è¡¥å……ï¼šthis é€ƒé€¸æ˜¯æŒ‡åœ¨æ„é€ å‡½æ•°è¿”å›ä¹‹å‰å…¶ä»–çº¿ç¨‹å°±æŒæœ‰è¯¥å¯¹è±¡çš„å¼•ç”¨. è°ƒç”¨å°šæœªæ„é€ å®Œå…¨çš„å¯¹è±¡çš„æ–¹æ³•å¯èƒ½å¼•å‘ä»¤äººç–‘æƒ‘çš„é”™è¯¯ã€‚</p></blockquote><p><code>Executor</code> æ¡†æ¶ä¸ä»…åŒ…æ‹¬äº†çº¿ç¨‹æ± çš„ç®¡ç†ï¼Œè¿˜æä¾›äº†çº¿ç¨‹å·¥å‚ã€é˜Ÿåˆ—ä»¥åŠæ‹’ç»ç­–ç•¥ç­‰ï¼Œ<code>Executor</code> æ¡†æ¶è®©å¹¶å‘ç¼–ç¨‹å˜å¾—æ›´åŠ ç®€å•ã€‚</p><h3 id="_2-2-executor-æ¡†æ¶ç»“æ„-ä¸»è¦ç”±ä¸‰å¤§éƒ¨åˆ†ç»„æˆ" tabindex="-1"><a class="header-anchor" href="#_2-2-executor-æ¡†æ¶ç»“æ„-ä¸»è¦ç”±ä¸‰å¤§éƒ¨åˆ†ç»„æˆ" aria-hidden="true">#</a> 2.2 Executor æ¡†æ¶ç»“æ„(ä¸»è¦ç”±ä¸‰å¤§éƒ¨åˆ†ç»„æˆ)</h3><h4 id="_1-ä»»åŠ¡-runnable-callable" tabindex="-1"><a class="header-anchor" href="#_1-ä»»åŠ¡-runnable-callable" aria-hidden="true">#</a> 1) ä»»åŠ¡(<code>Runnable</code> /<code>Callable</code>)</h4><p>æ‰§è¡Œä»»åŠ¡éœ€è¦å®ç°çš„ <strong><code>Runnable</code> æ¥å£</strong> æˆ– <strong><code>Callable</code>æ¥å£</strong>ã€‚<strong><code>Runnable</code> æ¥å£</strong>æˆ– <strong><code>Callable</code> æ¥å£</strong> å®ç°ç±»éƒ½å¯ä»¥è¢« <strong><code>ThreadPoolExecutor</code></strong> æˆ– <strong><code>ScheduledThreadPoolExecutor</code></strong> æ‰§è¡Œã€‚</p><h4 id="_2-ä»»åŠ¡çš„æ‰§è¡Œ-executor" tabindex="-1"><a class="header-anchor" href="#_2-ä»»åŠ¡çš„æ‰§è¡Œ-executor" aria-hidden="true">#</a> 2) ä»»åŠ¡çš„æ‰§è¡Œ(<code>Executor</code>)</h4><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒåŒ…æ‹¬ä»»åŠ¡æ‰§è¡Œæœºåˆ¶çš„æ ¸å¿ƒæ¥å£ <strong><code>Executor</code></strong> ï¼Œä»¥åŠç»§æ‰¿è‡ª <code>Executor</code> æ¥å£çš„ <strong><code>ExecutorService</code> æ¥å£ã€‚<code>ThreadPoolExecutor</code></strong> å’Œ <strong><code>ScheduledThreadPoolExecutor</code></strong> è¿™ä¸¤ä¸ªå…³é”®ç±»å®ç°äº† <strong>ExecutorService æ¥å£</strong>ã€‚</p><p><strong>è¿™é‡Œæäº†å¾ˆå¤šåº•å±‚çš„ç±»å…³ç³»ï¼Œä½†æ˜¯ï¼Œå®é™…ä¸Šæˆ‘ä»¬éœ€è¦æ›´å¤šå…³æ³¨çš„æ˜¯ <code>ThreadPoolExecutor</code> è¿™ä¸ªç±»ï¼Œè¿™ä¸ªç±»åœ¨æˆ‘ä»¬å®é™…ä½¿ç”¨çº¿ç¨‹æ± çš„è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨é¢‘ç‡è¿˜æ˜¯éå¸¸é«˜çš„ã€‚</strong></p><blockquote><p><strong>æ³¨æ„ï¼š</strong> é€šè¿‡æŸ¥çœ‹ <code>ScheduledThreadPoolExecutor</code> æºä»£ç æˆ‘ä»¬å‘ç° <code>ScheduledThreadPoolExecutor</code> å®é™…ä¸Šæ˜¯ç»§æ‰¿äº† <code>ThreadPoolExecutor</code> å¹¶å®ç°äº† ScheduledExecutorService ï¼Œè€Œ <code>ScheduledExecutorService</code> åˆå®ç°äº† <code>ExecutorService</code>ï¼Œæ­£å¦‚æˆ‘ä»¬ä¸‹é¢ç»™å‡ºçš„ç±»å…³ç³»å›¾æ˜¾ç¤ºçš„ä¸€æ ·ã€‚</p></blockquote><p><strong><code>ThreadPoolExecutor</code> ç±»æè¿°:</strong></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//AbstractExecutorServiceå®ç°äº†ExecutorServiceæ¥å£</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ThreadPoolExecutor</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractExecutorService</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong><code>ScheduledThreadPoolExecutor</code> ç±»æè¿°:</strong></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//ScheduledExecutorServiceç»§æ‰¿ExecutorServiceæ¥å£</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ScheduledThreadPoolExecutor</span>
        <span class="token keyword">extends</span> <span class="token class-name">ThreadPoolExecutor</span>
        <span class="token keyword">implements</span> <span class="token class-name">ScheduledExecutorService</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/assets/ä»»åŠ¡çš„æ‰§è¡Œç›¸å…³æ¥å£.27457eb8.png" alt="ä»»åŠ¡çš„æ‰§è¡Œç›¸å…³æ¥å£" loading="lazy"></p><h4 id="_3-å¼‚æ­¥è®¡ç®—çš„ç»“æœ-future" tabindex="-1"><a class="header-anchor" href="#_3-å¼‚æ­¥è®¡ç®—çš„ç»“æœ-future" aria-hidden="true">#</a> 3) å¼‚æ­¥è®¡ç®—çš„ç»“æœ(<code>Future</code>)</h4><p><strong><code>Future</code></strong> æ¥å£ä»¥åŠ <code>Future</code> æ¥å£çš„å®ç°ç±» <strong><code>FutureTask</code></strong> ç±»éƒ½å¯ä»¥ä»£è¡¨å¼‚æ­¥è®¡ç®—çš„ç»“æœã€‚</p><p>å½“æˆ‘ä»¬æŠŠ <strong><code>Runnable</code>æ¥å£</strong> æˆ– <strong><code>Callable</code> æ¥å£</strong> çš„å®ç°ç±»æäº¤ç»™ <strong><code>ThreadPoolExecutor</code></strong> æˆ– <strong><code>ScheduledThreadPoolExecutor</code></strong> æ‰§è¡Œã€‚ï¼ˆè°ƒç”¨ <code>submit()</code> æ–¹æ³•æ—¶ä¼šè¿”å›ä¸€ä¸ª <strong><code>FutureTask</code></strong> å¯¹è±¡ï¼‰</p><h3 id="_2-3-executor-æ¡†æ¶çš„ä½¿ç”¨ç¤ºæ„å›¾" tabindex="-1"><a class="header-anchor" href="#_2-3-executor-æ¡†æ¶çš„ä½¿ç”¨ç¤ºæ„å›¾" aria-hidden="true">#</a> 2.3 Executor æ¡†æ¶çš„ä½¿ç”¨ç¤ºæ„å›¾</h3><p><img src="/assets/Executoræ¡†æ¶çš„ä½¿ç”¨ç¤ºæ„å›¾.36e59afa.png" alt="Executor æ¡†æ¶çš„ä½¿ç”¨ç¤ºæ„å›¾" loading="lazy"></p><ol><li><strong>ä¸»çº¿ç¨‹é¦–å…ˆè¦åˆ›å»ºå®ç° <code>Runnable</code> æˆ–è€… <code>Callable</code> æ¥å£çš„ä»»åŠ¡å¯¹è±¡ã€‚</strong></li><li><strong>æŠŠåˆ›å»ºå®Œæˆçš„å®ç° <code>Runnable</code>/<code>Callable</code>æ¥å£çš„ å¯¹è±¡ç›´æ¥äº¤ç»™ <code>ExecutorService</code> æ‰§è¡Œ</strong>: <code>ExecutorService.executeï¼ˆRunnable commandï¼‰</code>ï¼‰æˆ–è€…ä¹Ÿå¯ä»¥æŠŠ <code>Runnable</code> å¯¹è±¡æˆ–<code>Callable</code> å¯¹è±¡æäº¤ç»™ <code>ExecutorService</code> æ‰§è¡Œï¼ˆ<code>ExecutorService.submitï¼ˆRunnable taskï¼‰</code>æˆ– <code>ExecutorService.submitï¼ˆCallable &lt;T&gt; taskï¼‰</code>ï¼‰ã€‚</li><li><strong>å¦‚æœæ‰§è¡Œ <code>ExecutorService.submitï¼ˆâ€¦ï¼‰</code>ï¼Œ<code>ExecutorService</code> å°†è¿”å›ä¸€ä¸ªå®ç°<code>Future</code>æ¥å£çš„å¯¹è±¡</strong>ï¼ˆæˆ‘ä»¬åˆšåˆšä¹Ÿæåˆ°è¿‡äº†æ‰§è¡Œ <code>execute()</code>æ–¹æ³•å’Œ <code>submit()</code>æ–¹æ³•çš„åŒºåˆ«ï¼Œ<code>submit()</code>ä¼šè¿”å›ä¸€ä¸ª <code>FutureTask å¯¹è±¡ï¼‰ã€‚ç”±äº FutureTask</code> å®ç°äº† <code>Runnable</code>ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ›å»º <code>FutureTask</code>ï¼Œç„¶åç›´æ¥äº¤ç»™ <code>ExecutorService</code> æ‰§è¡Œã€‚</li><li><strong>æœ€åï¼Œä¸»çº¿ç¨‹å¯ä»¥æ‰§è¡Œ <code>FutureTask.get()</code>æ–¹æ³•æ¥ç­‰å¾…ä»»åŠ¡æ‰§è¡Œå®Œæˆã€‚ä¸»çº¿ç¨‹ä¹Ÿå¯ä»¥æ‰§è¡Œ <code>FutureTask.cancelï¼ˆboolean mayInterruptIfRunningï¼‰</code>æ¥å–æ¶ˆæ­¤ä»»åŠ¡çš„æ‰§è¡Œã€‚</strong></li></ol><h2 id="ä¸‰-é‡è¦-threadpoolexecutor-ç±»ç®€å•ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#ä¸‰-é‡è¦-threadpoolexecutor-ç±»ç®€å•ä»‹ç»" aria-hidden="true">#</a> ä¸‰ (é‡è¦)ThreadPoolExecutor ç±»ç®€å•ä»‹ç»</h2><p><strong>çº¿ç¨‹æ± å®ç°ç±» <code>ThreadPoolExecutor</code> æ˜¯ <code>Executor</code> æ¡†æ¶æœ€æ ¸å¿ƒçš„ç±»ã€‚</strong></p><h3 id="_3-1-threadpoolexecutor-ç±»åˆ†æ" tabindex="-1"><a class="header-anchor" href="#_3-1-threadpoolexecutor-ç±»åˆ†æ" aria-hidden="true">#</a> 3.1 ThreadPoolExecutor ç±»åˆ†æ</h3><p><code>ThreadPoolExecutor</code> ç±»ä¸­æä¾›çš„å››ä¸ªæ„é€ æ–¹æ³•ã€‚æˆ‘ä»¬æ¥çœ‹æœ€é•¿çš„é‚£ä¸ªï¼Œå…¶ä½™ä¸‰ä¸ªéƒ½æ˜¯åœ¨è¿™ä¸ªæ„é€ æ–¹æ³•çš„åŸºç¡€ä¸Šäº§ç”Ÿï¼ˆå…¶ä»–å‡ ä¸ªæ„é€ æ–¹æ³•è¯´ç™½ç‚¹éƒ½æ˜¯ç»™å®šæŸäº›é»˜è®¤å‚æ•°çš„æ„é€ æ–¹æ³•æ¯”å¦‚é»˜è®¤åˆ¶å®šæ‹’ç»ç­–ç•¥æ˜¯ä»€ä¹ˆï¼‰ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token doc-comment comment">/**
     * ç”¨ç»™å®šçš„åˆå§‹å‚æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ThreadPoolExecutorã€‚
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token keyword">int</span> corePoolSize<span class="token punctuation">,</span><span class="token comment">//çº¿ç¨‹æ± çš„æ ¸å¿ƒçº¿ç¨‹æ•°é‡</span>
                              <span class="token keyword">int</span> maximumPoolSize<span class="token punctuation">,</span><span class="token comment">//çº¿ç¨‹æ± çš„æœ€å¤§çº¿ç¨‹æ•°</span>
                              <span class="token keyword">long</span> keepAliveTime<span class="token punctuation">,</span><span class="token comment">//å½“çº¿ç¨‹æ•°å¤§äºæ ¸å¿ƒçº¿ç¨‹æ•°æ—¶ï¼Œå¤šä½™çš„ç©ºé—²çº¿ç¨‹å­˜æ´»çš„æœ€é•¿æ—¶é—´</span>
                              <span class="token class-name">TimeUnit</span> unit<span class="token punctuation">,</span><span class="token comment">//æ—¶é—´å•ä½</span>
                              <span class="token class-name">BlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span> workQueue<span class="token punctuation">,</span><span class="token comment">//ä»»åŠ¡é˜Ÿåˆ—ï¼Œç”¨æ¥å‚¨å­˜ç­‰å¾…æ‰§è¡Œä»»åŠ¡çš„é˜Ÿåˆ—</span>
                              <span class="token class-name">ThreadFactory</span> threadFactory<span class="token punctuation">,</span><span class="token comment">//çº¿ç¨‹å·¥å‚ï¼Œç”¨æ¥åˆ›å»ºçº¿ç¨‹ï¼Œä¸€èˆ¬é»˜è®¤å³å¯</span>
                              <span class="token class-name">RejectedExecutionHandler</span> handler<span class="token comment">//æ‹’ç»ç­–ç•¥ï¼Œå½“æäº¤çš„ä»»åŠ¡è¿‡å¤šè€Œä¸èƒ½åŠæ—¶å¤„ç†æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å®šåˆ¶ç­–ç•¥æ¥å¤„ç†ä»»åŠ¡</span>
                               <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>corePoolSize <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span>
            maximumPoolSize <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span>
            maximumPoolSize <span class="token operator">&lt;</span> corePoolSize <span class="token operator">||</span>
            keepAliveTime <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>workQueue <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> threadFactory <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> handler <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>corePoolSize <span class="token operator">=</span> corePoolSize<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>maximumPoolSize <span class="token operator">=</span> maximumPoolSize<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>workQueue <span class="token operator">=</span> workQueue<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>keepAliveTime <span class="token operator">=</span> unit<span class="token punctuation">.</span><span class="token function">toNanos</span><span class="token punctuation">(</span>keepAliveTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>threadFactory <span class="token operator">=</span> threadFactory<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>handler <span class="token operator">=</span> handler<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸‹é¢è¿™äº›å¯¹åˆ›å»ºéå¸¸é‡è¦ï¼Œåœ¨åé¢ä½¿ç”¨çº¿ç¨‹æ± çš„è¿‡ç¨‹ä¸­ä½ ä¸€å®šä¼šç”¨åˆ°ï¼æ‰€ä»¥ï¼ŒåŠ¡å¿…æ‹¿ç€å°æœ¬æœ¬è®°æ¸…æ¥šã€‚</p><p><strong><code>ThreadPoolExecutor</code> 3 ä¸ªæœ€é‡è¦çš„å‚æ•°ï¼š</strong></p><ul><li><strong><code>corePoolSize</code> :</strong> æ ¸å¿ƒçº¿ç¨‹æ•°çº¿ç¨‹æ•°å®šä¹‰äº†æœ€å°å¯ä»¥åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡ã€‚</li><li><strong><code>maximumPoolSize</code> :</strong> å½“é˜Ÿåˆ—ä¸­å­˜æ”¾çš„ä»»åŠ¡è¾¾åˆ°é˜Ÿåˆ—å®¹é‡çš„æ—¶å€™ï¼Œå½“å‰å¯ä»¥åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡å˜ä¸ºæœ€å¤§çº¿ç¨‹æ•°ã€‚</li><li><strong><code>workQueue</code>:</strong> å½“æ–°ä»»åŠ¡æ¥çš„æ—¶å€™ä¼šå…ˆåˆ¤æ–­å½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°é‡æ˜¯å¦è¾¾åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œå¦‚æœè¾¾åˆ°çš„è¯ï¼Œæ–°ä»»åŠ¡å°±ä¼šè¢«å­˜æ”¾åœ¨é˜Ÿåˆ—ä¸­ã€‚</li></ul><p><code>ThreadPoolExecutor</code>å…¶ä»–å¸¸è§å‚æ•° :</p><ol><li><strong><code>keepAliveTime</code></strong>:å½“çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡å¤§äº <code>corePoolSize</code> çš„æ—¶å€™ï¼Œå¦‚æœè¿™æ—¶æ²¡æœ‰æ–°çš„ä»»åŠ¡æäº¤ï¼Œæ ¸å¿ƒçº¿ç¨‹å¤–çš„çº¿ç¨‹ä¸ä¼šç«‹å³é”€æ¯ï¼Œè€Œæ˜¯ä¼šç­‰å¾…ï¼Œç›´åˆ°ç­‰å¾…çš„æ—¶é—´è¶…è¿‡äº† <code>keepAliveTime</code>æ‰ä¼šè¢«å›æ”¶é”€æ¯ï¼›</li><li><strong><code>unit</code></strong> : <code>keepAliveTime</code> å‚æ•°çš„æ—¶é—´å•ä½ã€‚</li><li><strong><code>threadFactory</code></strong> :executor åˆ›å»ºæ–°çº¿ç¨‹çš„æ—¶å€™ä¼šç”¨åˆ°ã€‚</li><li><strong><code>handler</code></strong> :é¥±å’Œç­–ç•¥ã€‚å…³äºé¥±å’Œç­–ç•¥ä¸‹é¢å•ç‹¬ä»‹ç»ä¸€ä¸‹ã€‚</li></ol><p>ä¸‹é¢è¿™å¼ å›¾å¯ä»¥åŠ æ·±ä½ å¯¹çº¿ç¨‹æ± ä¸­å„ä¸ªå‚æ•°çš„ç›¸äº’å…³ç³»çš„ç†è§£ï¼ˆå›¾ç‰‡æ¥æºï¼šã€ŠJava æ€§èƒ½è°ƒä¼˜å®æˆ˜ã€‹ï¼‰ï¼š</p><p><img src="/assets/çº¿ç¨‹æ± å„ä¸ªå‚æ•°ä¹‹é—´çš„å…³ç³».d65f3309.png" alt="çº¿ç¨‹æ± å„ä¸ªå‚æ•°çš„å…³ç³»" loading="lazy"></p><p><strong><code>ThreadPoolExecutor</code> é¥±å’Œç­–ç•¥å®šä¹‰:</strong></p><p>å¦‚æœå½“å‰åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡è¾¾åˆ°æœ€å¤§çº¿ç¨‹æ•°é‡å¹¶ä¸”é˜Ÿåˆ—ä¹Ÿå·²ç»è¢«æ”¾æ»¡äº†ä»»åŠ¡æ—¶ï¼Œ<code>ThreadPoolTaskExecutor</code> å®šä¹‰ä¸€äº›ç­–ç•¥:</p><ul><li><strong><code>ThreadPoolExecutor.AbortPolicy</code></strong> ï¼šæŠ›å‡º <code>RejectedExecutionException</code>æ¥æ‹’ç»æ–°ä»»åŠ¡çš„å¤„ç†ã€‚</li><li><strong><code>ThreadPoolExecutor.CallerRunsPolicy</code></strong> ï¼šè°ƒç”¨æ‰§è¡Œè‡ªå·±çš„çº¿ç¨‹è¿è¡Œä»»åŠ¡ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥åœ¨è°ƒç”¨<code>execute</code>æ–¹æ³•çš„çº¿ç¨‹ä¸­è¿è¡Œ(<code>run</code>)è¢«æ‹’ç»çš„ä»»åŠ¡ï¼Œå¦‚æœæ‰§è¡Œç¨‹åºå·²å…³é—­ï¼Œåˆ™ä¼šä¸¢å¼ƒè¯¥ä»»åŠ¡ã€‚å› æ­¤è¿™ç§ç­–ç•¥ä¼šé™ä½å¯¹äºæ–°ä»»åŠ¡æäº¤é€Ÿåº¦ï¼Œå½±å“ç¨‹åºçš„æ•´ä½“æ€§èƒ½ã€‚å¦‚æœæ‚¨çš„åº”ç”¨ç¨‹åºå¯ä»¥æ‰¿å—æ­¤å»¶è¿Ÿå¹¶ä¸”ä½ è¦æ±‚ä»»ä½•ä¸€ä¸ªä»»åŠ¡è¯·æ±‚éƒ½è¦è¢«æ‰§è¡Œçš„è¯ï¼Œä½ å¯ä»¥é€‰æ‹©è¿™ä¸ªç­–ç•¥ã€‚</li><li><strong><code>ThreadPoolExecutor.DiscardPolicy</code></strong> ï¼šä¸å¤„ç†æ–°ä»»åŠ¡ï¼Œç›´æ¥ä¸¢å¼ƒæ‰ã€‚</li><li><strong><code>ThreadPoolExecutor.DiscardOldestPolicy</code></strong> ï¼š æ­¤ç­–ç•¥å°†ä¸¢å¼ƒæœ€æ—©çš„æœªå¤„ç†çš„ä»»åŠ¡è¯·æ±‚ã€‚</li></ul><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><blockquote><p>Spring é€šè¿‡ <code>ThreadPoolTaskExecutor</code> æˆ–è€…æˆ‘ä»¬ç›´æ¥é€šè¿‡ <code>ThreadPoolExecutor</code> çš„æ„é€ å‡½æ•°åˆ›å»ºçº¿ç¨‹æ± çš„æ—¶å€™ï¼Œå½“æˆ‘ä»¬ä¸æŒ‡å®š <code>RejectedExecutionHandler</code> é¥±å’Œç­–ç•¥çš„è¯æ¥é…ç½®çº¿ç¨‹æ± çš„æ—¶å€™é»˜è®¤ä½¿ç”¨çš„æ˜¯ <code>ThreadPoolExecutor.AbortPolicy</code>ã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>ThreadPoolExecutor</code> å°†æŠ›å‡º <code>RejectedExecutionException</code> æ¥æ‹’ç»æ–°æ¥çš„ä»»åŠ¡ ï¼Œè¿™ä»£è¡¨ä½ å°†ä¸¢å¤±å¯¹è¿™ä¸ªä»»åŠ¡çš„å¤„ç†ã€‚ å¯¹äºå¯ä¼¸ç¼©çš„åº”ç”¨ç¨‹åºï¼Œå»ºè®®ä½¿ç”¨ <code>ThreadPoolExecutor.CallerRunsPolicy</code>ã€‚å½“æœ€å¤§æ± è¢«å¡«æ»¡æ—¶ï¼Œæ­¤ç­–ç•¥ä¸ºæˆ‘ä»¬æä¾›å¯ä¼¸ç¼©é˜Ÿåˆ—ã€‚ï¼ˆè¿™ä¸ªç›´æ¥æŸ¥çœ‹ <code>ThreadPoolExecutor</code> çš„æ„é€ å‡½æ•°æºç å°±å¯ä»¥çœ‹å‡ºï¼Œæ¯”è¾ƒç®€å•çš„åŸå› ï¼Œè¿™é‡Œå°±ä¸è´´ä»£ç äº†ã€‚ï¼‰</p></blockquote><h3 id="_3-2-æ¨èä½¿ç”¨-threadpoolexecutor-æ„é€ å‡½æ•°åˆ›å»ºçº¿ç¨‹æ± " tabindex="-1"><a class="header-anchor" href="#_3-2-æ¨èä½¿ç”¨-threadpoolexecutor-æ„é€ å‡½æ•°åˆ›å»ºçº¿ç¨‹æ± " aria-hidden="true">#</a> 3.2 æ¨èä½¿ç”¨ <code>ThreadPoolExecutor</code> æ„é€ å‡½æ•°åˆ›å»ºçº¿ç¨‹æ± </h3><p>åœ¨ã€Šé˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œã€‹â€œå¹¶å‘å¤„ç†â€è¿™ä¸€ç« èŠ‚ï¼Œæ˜ç¡®æŒ‡å‡ºçº¿ç¨‹èµ„æºå¿…é¡»é€šè¿‡çº¿ç¨‹æ± æä¾›ï¼Œä¸å…è®¸åœ¨åº”ç”¨ä¸­è‡ªè¡Œæ˜¾å¼åˆ›å»ºçº¿ç¨‹ã€‚</p><p><strong>ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</strong></p><blockquote><p>ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„æ˜¯å‡å°‘åœ¨åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹ä¸Šæ‰€æ¶ˆè€—çš„æ—¶é—´ä»¥åŠç³»ç»Ÿèµ„æºå¼€é”€ï¼Œè§£å†³èµ„æºä¸è¶³çš„é—®é¢˜ã€‚å¦‚æœä¸ä½¿ç”¨çº¿ç¨‹æ± ï¼Œæœ‰å¯èƒ½ä¼šé€ æˆç³»ç»Ÿåˆ›å»ºå¤§é‡åŒç±»çº¿ç¨‹è€Œå¯¼è‡´æ¶ˆè€—å®Œå†…å­˜æˆ–è€…â€œè¿‡åº¦åˆ‡æ¢â€çš„é—®é¢˜ã€‚</p></blockquote><p>å¦å¤–ï¼Œã€Šé˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œã€‹ä¸­å¼ºåˆ¶çº¿ç¨‹æ± ä¸å…è®¸ä½¿ç”¨ <code>Executors</code> å»åˆ›å»ºï¼Œè€Œæ˜¯é€šè¿‡ <code>ThreadPoolExecutor</code> æ„é€ å‡½æ•°çš„æ–¹å¼ï¼Œè¿™æ ·çš„å¤„ç†æ–¹å¼è®©å†™çš„åŒå­¦æ›´åŠ æ˜ç¡®çº¿ç¨‹æ± çš„è¿è¡Œè§„åˆ™ï¼Œè§„é¿èµ„æºè€—å°½çš„é£é™©</p><blockquote><p><code>Executors</code> è¿”å›çº¿ç¨‹æ± å¯¹è±¡çš„å¼Šç«¯å¦‚ä¸‹(åæ–‡ä¼šè¯¦ç»†ä»‹ç»åˆ°)ï¼š</p><ul><li><strong><code>FixedThreadPool</code> å’Œ <code>SingleThreadExecutor</code></strong> ï¼š å…è®¸è¯·æ±‚çš„é˜Ÿåˆ—é•¿åº¦ä¸º <code>Integer.MAX_VALUE</code>,å¯èƒ½å †ç§¯å¤§é‡çš„è¯·æ±‚ï¼Œä»è€Œå¯¼è‡´ OOMã€‚</li><li><strong><code>CachedThreadPool</code> å’Œ <code>ScheduledThreadPool</code></strong> ï¼š å…è®¸åˆ›å»ºçš„çº¿ç¨‹æ•°é‡ä¸º <code>Integer.MAX_VALUE</code> ï¼Œå¯èƒ½ä¼šåˆ›å»ºå¤§é‡çº¿ç¨‹ï¼Œä»è€Œå¯¼è‡´ OOMã€‚</li></ul></blockquote><p><strong>æ–¹å¼ä¸€ï¼šé€šè¿‡<code>ThreadPoolExecutor</code>æ„é€ å‡½æ•°å®ç°ï¼ˆæ¨èï¼‰</strong><img src="/assets/threadpoolexecutoræ„é€ å‡½æ•°.d54a5992.png" alt="é€šè¿‡æ„é€ æ–¹æ³•å®ç°" loading="lazy"></p><p><strong>æ–¹å¼äºŒï¼šé€šè¿‡ <code>Executor</code> æ¡†æ¶çš„å·¥å…·ç±» <code>Executors</code> æ¥å®ç°</strong> æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸‰ç§ç±»å‹çš„ <code>ThreadPoolExecutor</code>ï¼š</p><ul><li><code>FixedThreadPool</code></li><li><code>SingleThreadExecutor</code></li><li>CachedThreadPool</li></ul><p>å¯¹åº” Executors å·¥å…·ç±»ä¸­çš„æ–¹æ³•å¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="/assets/Executorså·¥å…·ç±».4b0cbd16.png" alt="é€šè¿‡Executor æ¡†æ¶çš„å·¥å…·ç±»Executorsæ¥å®ç°" loading="lazy"></p><h2 id="å››-threadpoolexecutor-ä½¿ç”¨-åŸç†åˆ†æ" tabindex="-1"><a class="header-anchor" href="#å››-threadpoolexecutor-ä½¿ç”¨-åŸç†åˆ†æ" aria-hidden="true">#</a> å›› ThreadPoolExecutor ä½¿ç”¨+åŸç†åˆ†æ</h2><p>æˆ‘ä»¬ä¸Šé¢è®²è§£äº† <code>Executor</code>æ¡†æ¶ä»¥åŠ <code>ThreadPoolExecutor</code> ç±»ï¼Œä¸‹é¢è®©æˆ‘ä»¬å®æˆ˜ä¸€ä¸‹ï¼Œæ¥é€šè¿‡å†™ä¸€ä¸ª <code>ThreadPoolExecutor</code> çš„å° Demo æ¥å›é¡¾ä¸Šé¢çš„å†…å®¹ã€‚</p><h3 id="_4-1-ç¤ºä¾‹ä»£ç -runnable-threadpoolexecutor" tabindex="-1"><a class="header-anchor" href="#_4-1-ç¤ºä¾‹ä»£ç -runnable-threadpoolexecutor" aria-hidden="true">#</a> 4.1 ç¤ºä¾‹ä»£ç :<code>Runnable</code>+<code>ThreadPoolExecutor</code></h3><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ª <code>Runnable</code> æ¥å£çš„å®ç°ç±»ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥æ˜¯ <code>Callable</code> æ¥å£ï¼Œæˆ‘ä»¬ä¸Šé¢ä¹Ÿè¯´äº†ä¸¤è€…çš„åŒºåˆ«ã€‚ï¼‰</p><p><code>MyRunnable.java</code></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * è¿™æ˜¯ä¸€ä¸ªç®€å•çš„Runnableç±»ï¼Œéœ€è¦å¤§çº¦5ç§’é’Ÿæ¥æ‰§è¡Œå…¶ä»»åŠ¡ã€‚
 * <span class="token keyword">@author</span> shuang.kou
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyRunnable</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> command<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">MyRunnable</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>command <span class="token operator">=</span> s<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; Start. Time = &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">processCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; End. Time = &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">processCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>command<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¼–å†™æµ‹è¯•ç¨‹åºï¼Œæˆ‘ä»¬è¿™é‡Œä»¥é˜¿é‡Œå·´å·´æ¨èçš„ä½¿ç”¨ <code>ThreadPoolExecutor</code> æ„é€ å‡½æ•°è‡ªå®šä¹‰å‚æ•°çš„æ–¹å¼æ¥åˆ›å»ºçº¿ç¨‹æ± ã€‚</p><p><code>ThreadPoolExecutorDemo.java</code></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">ArrayBlockingQueue</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">ThreadPoolExecutor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">TimeUnit</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ThreadPoolExecutorDemo</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> CORE_POOL_SIZE <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> MAX_POOL_SIZE <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> QUEUE_CAPACITY <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Long</span> KEEP_ALIVE_TIME <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">//ä½¿ç”¨é˜¿é‡Œå·´å·´æ¨èçš„åˆ›å»ºçº¿ç¨‹æ± çš„æ–¹å¼</span>
        <span class="token comment">//é€šè¿‡ThreadPoolExecutoræ„é€ å‡½æ•°è‡ªå®šä¹‰å‚æ•°åˆ›å»º</span>
        <span class="token class-name">ThreadPoolExecutor</span> executor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span>
                CORE_POOL_SIZE<span class="token punctuation">,</span>
                MAX_POOL_SIZE<span class="token punctuation">,</span>
                KEEP_ALIVE_TIME<span class="token punctuation">,</span>
                <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">ArrayBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>QUEUE_CAPACITY<span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor<span class="token punctuation">.</span>CallerRunsPolicy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//åˆ›å»ºWorkerThreadå¯¹è±¡ï¼ˆWorkerThreadç±»å®ç°äº†Runnable æ¥å£ï¼‰</span>
            <span class="token class-name">Runnable</span> worker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyRunnable</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//æ‰§è¡ŒRunnable</span>
            executor<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>worker<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//ç»ˆæ­¢çº¿ç¨‹æ± </span>
        executor<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>executor<span class="token punctuation">.</span><span class="token function">isTerminated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Finished all threads&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¸Šé¢çš„ä»£ç æŒ‡å®šäº†ï¼š</p><ol><li><code>corePoolSize</code>: æ ¸å¿ƒçº¿ç¨‹æ•°ä¸º 5ã€‚</li><li><code>maximumPoolSize</code> ï¼šæœ€å¤§çº¿ç¨‹æ•° 10</li><li><code>keepAliveTime</code> : ç­‰å¾…æ—¶é—´ä¸º 1Lã€‚</li><li><code>unit</code>: ç­‰å¾…æ—¶é—´çš„å•ä½ä¸º TimeUnit.SECONDSã€‚</li><li><code>workQueue</code>ï¼šä»»åŠ¡é˜Ÿåˆ—ä¸º <code>ArrayBlockingQueue</code>ï¼Œå¹¶ä¸”å®¹é‡ä¸º 100;</li><li><code>handler</code>:é¥±å’Œç­–ç•¥ä¸º <code>CallerRunsPolicy</code>ã€‚</li></ol><p><strong>Outputï¼š</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>pool-1-thread-3 Start. Time = Sun Apr 12 11:14:37 CST 2020
pool-1-thread-5 Start. Time = Sun Apr 12 11:14:37 CST 2020
pool-1-thread-2 Start. Time = Sun Apr 12 11:14:37 CST 2020
pool-1-thread-1 Start. Time = Sun Apr 12 11:14:37 CST 2020
pool-1-thread-4 Start. Time = Sun Apr 12 11:14:37 CST 2020
pool-1-thread-3 End. Time = Sun Apr 12 11:14:42 CST 2020
pool-1-thread-4 End. Time = Sun Apr 12 11:14:42 CST 2020
pool-1-thread-1 End. Time = Sun Apr 12 11:14:42 CST 2020
pool-1-thread-5 End. Time = Sun Apr 12 11:14:42 CST 2020
pool-1-thread-1 Start. Time = Sun Apr 12 11:14:42 CST 2020
pool-1-thread-2 End. Time = Sun Apr 12 11:14:42 CST 2020
pool-1-thread-5 Start. Time = Sun Apr 12 11:14:42 CST 2020
pool-1-thread-4 Start. Time = Sun Apr 12 11:14:42 CST 2020
pool-1-thread-3 Start. Time = Sun Apr 12 11:14:42 CST 2020
pool-1-thread-2 Start. Time = Sun Apr 12 11:14:42 CST 2020
pool-1-thread-1 End. Time = Sun Apr 12 11:14:47 CST 2020
pool-1-thread-4 End. Time = Sun Apr 12 11:14:47 CST 2020
pool-1-thread-5 End. Time = Sun Apr 12 11:14:47 CST 2020
pool-1-thread-3 End. Time = Sun Apr 12 11:14:47 CST 2020
pool-1-thread-2 End. Time = Sun Apr 12 11:14:47 CST 2020

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-2-çº¿ç¨‹æ± åŸç†åˆ†æ" tabindex="-1"><a class="header-anchor" href="#_4-2-çº¿ç¨‹æ± åŸç†åˆ†æ" aria-hidden="true">#</a> 4.2 çº¿ç¨‹æ± åŸç†åˆ†æ</h3><p>æ‰¿æ¥ 4.1 èŠ‚ï¼Œæˆ‘ä»¬é€šè¿‡ä»£ç è¾“å‡ºç»“æœå¯ä»¥çœ‹å‡ºï¼š<strong>çº¿ç¨‹æ± é¦–å…ˆä¼šå…ˆæ‰§è¡Œ 5 ä¸ªä»»åŠ¡ï¼Œç„¶åè¿™äº›ä»»åŠ¡æœ‰ä»»åŠ¡è¢«æ‰§è¡Œå®Œçš„è¯ï¼Œå°±ä¼šå»æ‹¿æ–°çš„ä»»åŠ¡æ‰§è¡Œã€‚</strong> å¤§å®¶å¯ä»¥å…ˆé€šè¿‡ä¸Šé¢è®²è§£çš„å†…å®¹ï¼Œåˆ†æä¸€ä¸‹åˆ°åº•æ˜¯å’‹å›äº‹ï¼Ÿï¼ˆè‡ªå·±ç‹¬ç«‹æ€è€ƒä¸€ä¼šï¼‰</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬å°±åˆ†æä¸Šé¢çš„è¾“å‡ºå†…å®¹æ¥ç®€å•åˆ†æä¸€ä¸‹çº¿ç¨‹æ± åŸç†ã€‚</p><p><strong>ä¸ºäº†ææ‡‚çº¿ç¨‹æ± çš„åŸç†ï¼Œæˆ‘ä»¬éœ€è¦é¦–å…ˆåˆ†æä¸€ä¸‹ <code>execute</code>æ–¹æ³•ã€‚</strong> åœ¨ 4.1 èŠ‚ä¸­çš„ Demo ä¸­æˆ‘ä»¬ä½¿ç”¨ <code>executor.execute(worker)</code>æ¥æäº¤ä¸€ä¸ªä»»åŠ¡åˆ°çº¿ç¨‹æ± ä¸­å»ï¼Œè¿™ä¸ªæ–¹æ³•éå¸¸é‡è¦ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒçš„æºç ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>   <span class="token comment">// å­˜æ”¾çº¿ç¨‹æ± çš„è¿è¡ŒçŠ¶æ€ (runState) å’Œçº¿ç¨‹æ± å†…æœ‰æ•ˆçº¿ç¨‹çš„æ•°é‡ (workerCount)</span>
   <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">AtomicInteger</span> ctl <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicInteger</span><span class="token punctuation">(</span><span class="token function">ctlOf</span><span class="token punctuation">(</span>RUNNING<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">workerCountOf</span><span class="token punctuation">(</span><span class="token keyword">int</span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> c <span class="token operator">&amp;</span> CAPACITY<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//ä»»åŠ¡é˜Ÿåˆ—</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">BlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span> workQueue<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> command<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å¦‚æœä»»åŠ¡ä¸ºnullï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>command <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ctl ä¸­ä¿å­˜çš„çº¿ç¨‹æ± å½“å‰çš„ä¸€äº›çŠ¶æ€ä¿¡æ¯</span>
        <span class="token keyword">int</span> c <span class="token operator">=</span> ctl<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//  ä¸‹é¢ä¼šæ¶‰åŠåˆ° 3 æ­¥ æ“ä½œ</span>
        <span class="token comment">// 1.é¦–å…ˆåˆ¤æ–­å½“å‰çº¿ç¨‹æ± ä¸­ä¹‹è¡Œçš„ä»»åŠ¡æ•°é‡æ˜¯å¦å°äº corePoolSize</span>
        <span class="token comment">// å¦‚æœå°äºçš„è¯ï¼Œé€šè¿‡addWorker(command, true)æ–°å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œå¹¶å°†ä»»åŠ¡(command)æ·»åŠ åˆ°è¯¥çº¿ç¨‹ä¸­ï¼›ç„¶åï¼Œå¯åŠ¨è¯¥çº¿ç¨‹ä»è€Œæ‰§è¡Œä»»åŠ¡ã€‚</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">workerCountOf</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">&lt;</span> corePoolSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">addWorker</span><span class="token punctuation">(</span>command<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            c <span class="token operator">=</span> ctl<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 2.å¦‚æœå½“å‰ä¹‹è¡Œçš„ä»»åŠ¡æ•°é‡å¤§äºç­‰äº corePoolSize çš„æ—¶å€™å°±ä¼šèµ°åˆ°è¿™é‡Œ</span>
        <span class="token comment">// é€šè¿‡ isRunning æ–¹æ³•åˆ¤æ–­çº¿ç¨‹æ± çŠ¶æ€ï¼Œçº¿ç¨‹æ± å¤„äº RUNNING çŠ¶æ€å¹¶ä¸”é˜Ÿåˆ—å¯ä»¥åŠ å…¥ä»»åŠ¡ï¼Œè¯¥ä»»åŠ¡æ‰ä¼šè¢«åŠ å…¥è¿›å»</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isRunning</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> workQueue<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> recheck <span class="token operator">=</span> ctl<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// å†æ¬¡è·å–çº¿ç¨‹æ± çŠ¶æ€ï¼Œå¦‚æœçº¿ç¨‹æ± çŠ¶æ€ä¸æ˜¯ RUNNING çŠ¶æ€å°±éœ€è¦ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­ç§»é™¤ä»»åŠ¡ï¼Œå¹¶å°è¯•åˆ¤æ–­çº¿ç¨‹æ˜¯å¦å…¨éƒ¨æ‰§è¡Œå®Œæ¯•ã€‚åŒæ—¶æ‰§è¡Œæ‹’ç»ç­–ç•¥ã€‚</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isRunning</span><span class="token punctuation">(</span>recheck<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">remove</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token function">reject</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// å¦‚æœå½“å‰çº¿ç¨‹æ± ä¸ºç©ºå°±æ–°åˆ›å»ºä¸€ä¸ªçº¿ç¨‹å¹¶æ‰§è¡Œã€‚</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">workerCountOf</span><span class="token punctuation">(</span>recheck<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token function">addWorker</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//3. é€šè¿‡addWorker(command, false)æ–°å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œå¹¶å°†ä»»åŠ¡(command)æ·»åŠ åˆ°è¯¥çº¿ç¨‹ä¸­ï¼›ç„¶åï¼Œå¯åŠ¨è¯¥çº¿ç¨‹ä»è€Œæ‰§è¡Œä»»åŠ¡ã€‚</span>
        <span class="token comment">//å¦‚æœaddWorker(command, false)æ‰§è¡Œå¤±è´¥ï¼Œåˆ™é€šè¿‡reject()æ‰§è¡Œç›¸åº”çš„æ‹’ç»ç­–ç•¥çš„å†…å®¹ã€‚</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">addWorker</span><span class="token punctuation">(</span>command<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token function">reject</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡ä¸‹å›¾å¯ä»¥æ›´å¥½çš„å¯¹ä¸Šé¢è¿™ 3 æ­¥åšä¸€ä¸ªå±•ç¤ºï¼Œä¸‹å›¾æ˜¯æˆ‘ä¸ºäº†çœäº‹ç›´æ¥ä»ç½‘ä¸Šæ‰¾åˆ°ï¼ŒåŸåœ°å€ä¸æ˜ã€‚</p><p><img src="/assets/image-20220730200357.f4a98b6a.png" alt="å›¾è§£çº¿ç¨‹æ± å®ç°åŸç†" loading="lazy"></p><p><strong><code>addWorker</code> è¿™ä¸ªæ–¹æ³•ä¸»è¦ç”¨æ¥åˆ›å»ºæ–°çš„å·¥ä½œçº¿ç¨‹ï¼Œå¦‚æœè¿”å› true è¯´æ˜åˆ›å»ºå’Œå¯åŠ¨å·¥ä½œçº¿ç¨‹æˆåŠŸï¼Œå¦åˆ™çš„è¯è¿”å›çš„å°±æ˜¯ falseã€‚</strong></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token comment">// å…¨å±€é”ï¼Œå¹¶å‘æ“ä½œå¿…å¤‡</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ReentrantLock</span> mainLock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è·Ÿè¸ªçº¿ç¨‹æ± çš„æœ€å¤§å¤§å°ï¼Œåªæœ‰åœ¨æŒæœ‰å…¨å±€é”mainLockçš„å‰æä¸‹æ‰èƒ½è®¿é—®æ­¤é›†åˆ</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> largestPoolSize<span class="token punctuation">;</span>
    <span class="token comment">// å·¥ä½œçº¿ç¨‹é›†åˆï¼Œå­˜æ”¾çº¿ç¨‹æ± ä¸­æ‰€æœ‰çš„ï¼ˆæ´»è·ƒçš„ï¼‰å·¥ä½œçº¿ç¨‹ï¼Œåªæœ‰åœ¨æŒæœ‰å…¨å±€é”mainLockçš„å‰æä¸‹æ‰èƒ½è®¿é—®æ­¤é›†åˆ</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Worker</span><span class="token punctuation">&gt;</span></span> workers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è·å–çº¿ç¨‹æ± çŠ¶æ€</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">runStateOf</span><span class="token punctuation">(</span><span class="token keyword">int</span> c<span class="token punctuation">)</span>     <span class="token punctuation">{</span> <span class="token keyword">return</span> c <span class="token operator">&amp;</span> <span class="token operator">~</span>CAPACITY<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token comment">//åˆ¤æ–­çº¿ç¨‹æ± çš„çŠ¶æ€æ˜¯å¦ä¸º Running</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">isRunning</span><span class="token punctuation">(</span><span class="token keyword">int</span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> c <span class="token operator">&lt;</span> SHUTDOWN<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token doc-comment comment">/**
     * æ·»åŠ æ–°çš„å·¥ä½œçº¿ç¨‹åˆ°çº¿ç¨‹æ± 
     * <span class="token keyword">@param</span> <span class="token parameter">firstTask</span> è¦æ‰§è¡Œ
     * <span class="token keyword">@param</span> <span class="token parameter">core</span>å‚æ•°ä¸ºtrueçš„è¯è¡¨ç¤ºä½¿ç”¨çº¿ç¨‹æ± çš„åŸºæœ¬å¤§å°ï¼Œä¸ºfalseä½¿ç”¨çº¿ç¨‹æ± æœ€å¤§å¤§å°
     * <span class="token keyword">@return</span> æ·»åŠ æˆåŠŸå°±è¿”å›trueå¦åˆ™è¿”å›false
     */</span>
   <span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">addWorker</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> firstTask<span class="token punctuation">,</span> <span class="token keyword">boolean</span> core<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        retry<span class="token operator">:</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//è¿™ä¸¤å¥ç”¨æ¥è·å–çº¿ç¨‹æ± çš„çŠ¶æ€</span>
            <span class="token keyword">int</span> c <span class="token operator">=</span> ctl<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> rs <span class="token operator">=</span> <span class="token function">runStateOf</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// Check if queue empty only if necessary.</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>rs <span class="token operator">&gt;=</span> SHUTDOWN <span class="token operator">&amp;&amp;</span>
                <span class="token operator">!</span> <span class="token punctuation">(</span>rs <span class="token operator">==</span> SHUTDOWN <span class="token operator">&amp;&amp;</span>
                   firstTask <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span>
                   <span class="token operator">!</span> workQueue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token comment">//è·å–çº¿ç¨‹æ± ä¸­å·¥ä½œçš„çº¿ç¨‹çš„æ•°é‡</span>
                <span class="token keyword">int</span> wc <span class="token operator">=</span> <span class="token function">workerCountOf</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// coreå‚æ•°ä¸ºtrueçš„è¯è¡¨æ˜é˜Ÿåˆ—ä¹Ÿæ»¡äº†ï¼Œçº¿ç¨‹æ± å¤§å°å˜ä¸º maximumPoolSize</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>wc <span class="token operator">&gt;=</span> CAPACITY <span class="token operator">||</span>
                    wc <span class="token operator">&gt;=</span> <span class="token punctuation">(</span>core <span class="token operator">?</span> corePoolSize <span class="token operator">:</span> maximumPoolSize<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
               <span class="token comment">//åŸå­æ“ä½œå°†workcountçš„æ•°é‡åŠ 1</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">compareAndIncrementWorkerCount</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token keyword">break</span> retry<span class="token punctuation">;</span>
                <span class="token comment">// å¦‚æœçº¿ç¨‹çš„çŠ¶æ€æ”¹å˜äº†å°±å†æ¬¡æ‰§è¡Œä¸Šè¿°æ“ä½œ</span>
                c <span class="token operator">=</span> ctl<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">runStateOf</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">!=</span> rs<span class="token punctuation">)</span>
                    <span class="token keyword">continue</span> retry<span class="token punctuation">;</span>
                <span class="token comment">// else CAS failed due to workerCount change; retry inner loop</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// æ ‡è®°å·¥ä½œçº¿ç¨‹æ˜¯å¦å¯åŠ¨æˆåŠŸ</span>
        <span class="token keyword">boolean</span> workerStarted <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token comment">// æ ‡è®°å·¥ä½œçº¿ç¨‹æ˜¯å¦åˆ›å»ºæˆåŠŸ</span>
        <span class="token keyword">boolean</span> workerAdded <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token class-name">Worker</span> w <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>

            w <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Worker</span><span class="token punctuation">(</span>firstTask<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">final</span> <span class="token class-name">Thread</span> t <span class="token operator">=</span> w<span class="token punctuation">.</span>thread<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>t <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              <span class="token comment">// åŠ é”</span>
                <span class="token keyword">final</span> <span class="token class-name">ReentrantLock</span> mainLock <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mainLock<span class="token punctuation">;</span>
                mainLock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                   <span class="token comment">//è·å–çº¿ç¨‹æ± çŠ¶æ€</span>
                    <span class="token keyword">int</span> rs <span class="token operator">=</span> <span class="token function">runStateOf</span><span class="token punctuation">(</span>ctl<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                   <span class="token comment">//rs &lt; SHUTDOWN å¦‚æœçº¿ç¨‹æ± çŠ¶æ€ä¾ç„¶ä¸ºRUNNING,å¹¶ä¸”çº¿ç¨‹çš„çŠ¶æ€æ˜¯å­˜æ´»çš„è¯ï¼Œå°±ä¼šå°†å·¥ä½œçº¿ç¨‹æ·»åŠ åˆ°å·¥ä½œçº¿ç¨‹é›†åˆä¸­</span>
                  <span class="token comment">//(rs=SHUTDOWN &amp;&amp; firstTask == null)å¦‚æœçº¿ç¨‹æ± çŠ¶æ€å°äºSTOPï¼Œä¹Ÿå°±æ˜¯RUNNINGæˆ–è€…SHUTDOWNçŠ¶æ€ä¸‹ï¼ŒåŒæ—¶ä¼ å…¥çš„ä»»åŠ¡å®ä¾‹firstTaskä¸ºnullï¼Œåˆ™éœ€è¦æ·»åŠ åˆ°å·¥ä½œçº¿ç¨‹é›†åˆå’Œå¯åŠ¨æ–°çš„Worker</span>
                   <span class="token comment">// firstTask == nullè¯æ˜åªæ–°å»ºçº¿ç¨‹è€Œä¸æ‰§è¡Œä»»åŠ¡</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>rs <span class="token operator">&lt;</span> SHUTDOWN <span class="token operator">||</span>
                        <span class="token punctuation">(</span>rs <span class="token operator">==</span> SHUTDOWN <span class="token operator">&amp;&amp;</span> firstTask <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">isAlive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// precheck that t is startable</span>
                            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalThreadStateException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        workers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span><span class="token punctuation">;</span>
                       <span class="token comment">//æ›´æ–°å½“å‰å·¥ä½œçº¿ç¨‹çš„æœ€å¤§å®¹é‡</span>
                        <span class="token keyword">int</span> s <span class="token operator">=</span> workers<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">&gt;</span> largestPoolSize<span class="token punctuation">)</span>
                            largestPoolSize <span class="token operator">=</span> s<span class="token punctuation">;</span>
                      <span class="token comment">// å·¥ä½œçº¿ç¨‹æ˜¯å¦å¯åŠ¨æˆåŠŸ</span>
                        workerAdded <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
                    <span class="token comment">// é‡Šæ”¾é”</span>
                    mainLock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token comment">//// å¦‚æœæˆåŠŸæ·»åŠ å·¥ä½œçº¿ç¨‹ï¼Œåˆ™è°ƒç”¨Workerå†…éƒ¨çš„çº¿ç¨‹å®ä¾‹tçš„Thread#start()æ–¹æ³•å¯åŠ¨çœŸå®çš„çº¿ç¨‹å®ä¾‹</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>workerAdded<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    t<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                  <span class="token comment">/// æ ‡è®°çº¿ç¨‹å¯åŠ¨æˆåŠŸ</span>
                    workerStarted <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
           <span class="token comment">// çº¿ç¨‹å¯åŠ¨å¤±è´¥ï¼Œéœ€è¦ä»å·¥ä½œçº¿ç¨‹ä¸­ç§»é™¤å¯¹åº”çš„Worker</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span> workerStarted<span class="token punctuation">)</span>
                <span class="token function">addWorkerFailed</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> workerStarted<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ›´å¤šå…³äºçº¿ç¨‹æ± æºç åˆ†æçš„å†…å®¹æ¨èè¿™ç¯‡æ–‡ç« ï¼šç¡¬æ ¸å¹²è´§ï¼š<a href="https://www.throwx.cn/2020/08/23/java-concurrency-thread-pool-executor/" target="_blank" rel="noopener noreferrer">4Wå­—ä»æºç ä¸Šåˆ†æJUCçº¿ç¨‹æ± ThreadPoolExecutorçš„å®ç°åŸç†<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬åœ¨å›åˆ° 4.1 èŠ‚æˆ‘ä»¬å†™çš„ Demoï¼Œ ç°åœ¨åº”è¯¥æ˜¯ä¸æ˜¯å¾ˆå®¹æ˜“å°±å¯ä»¥ææ‡‚å®ƒçš„åŸç†äº†å‘¢ï¼Ÿ</p><p>æ²¡ææ‡‚çš„è¯ï¼Œä¹Ÿæ²¡å…³ç³»ï¼Œå¯ä»¥çœ‹çœ‹æˆ‘çš„åˆ†æï¼š</p><blockquote><p>æˆ‘ä»¬åœ¨ä»£ç ä¸­æ¨¡æ‹Ÿäº† 10 ä¸ªä»»åŠ¡ï¼Œæˆ‘ä»¬é…ç½®çš„æ ¸å¿ƒçº¿ç¨‹æ•°ä¸º 5 ã€ç­‰å¾…é˜Ÿåˆ—å®¹é‡ä¸º 100 ï¼Œæ‰€ä»¥æ¯æ¬¡åªå¯èƒ½å­˜åœ¨ 5 ä¸ªä»»åŠ¡åŒæ—¶æ‰§è¡Œï¼Œå‰©ä¸‹çš„ 5 ä¸ªä»»åŠ¡ä¼šè¢«æ”¾åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­å»ã€‚å½“å‰çš„ 5 ä¸ªä»»åŠ¡ä¸­å¦‚æœæœ‰ä»»åŠ¡è¢«æ‰§è¡Œå®Œäº†ï¼Œçº¿ç¨‹æ± å°±ä¼šå»æ‹¿æ–°çš„ä»»åŠ¡æ‰§è¡Œã€‚</p></blockquote><h3 id="_4-3-å‡ ä¸ªå¸¸è§çš„å¯¹æ¯”" tabindex="-1"><a class="header-anchor" href="#_4-3-å‡ ä¸ªå¸¸è§çš„å¯¹æ¯”" aria-hidden="true">#</a> 4.3 å‡ ä¸ªå¸¸è§çš„å¯¹æ¯”</h3><h4 id="_4-3-1-runnable-vs-callable" tabindex="-1"><a class="header-anchor" href="#_4-3-1-runnable-vs-callable" aria-hidden="true">#</a> 4.3.1 <code>Runnable</code> vs <code>Callable</code></h4><p><code>Runnable</code>è‡ª Java 1.0 ä»¥æ¥ä¸€ç›´å­˜åœ¨ï¼Œä½†<code>Callable</code>ä»…åœ¨ Java 1.5 ä¸­å¼•å…¥,ç›®çš„å°±æ˜¯ä¸ºäº†æ¥å¤„ç†<code>Runnable</code>ä¸æ”¯æŒçš„ç”¨ä¾‹ã€‚<strong><code>Runnable</code> æ¥å£</strong>ä¸ä¼šè¿”å›ç»“æœæˆ–æŠ›å‡ºæ£€æŸ¥å¼‚å¸¸ï¼Œä½†æ˜¯ <strong><code>Callable</code> æ¥å£</strong>å¯ä»¥ã€‚æ‰€ä»¥ï¼Œå¦‚æœä»»åŠ¡ä¸éœ€è¦è¿”å›ç»“æœæˆ–æŠ›å‡ºå¼‚å¸¸æ¨èä½¿ç”¨ <strong><code>Runnable</code> æ¥å£</strong>ï¼Œè¿™æ ·ä»£ç çœ‹èµ·æ¥ä¼šæ›´åŠ ç®€æ´ã€‚</p><p>å·¥å…·ç±» <code>Executors</code> å¯ä»¥å®ç°å°† <code>Runnable</code> å¯¹è±¡è½¬æ¢æˆ <code>Callable</code> å¯¹è±¡ã€‚ï¼ˆ<code>Executors.callable(Runnable task)</code> æˆ– <code>Executors.callable(Runnable task, Object result)</code>ï¼‰ã€‚</p><p><code>Runnable.java</code></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@FunctionalInterface</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
   <span class="token doc-comment comment">/**
    * è¢«çº¿ç¨‹æ‰§è¡Œï¼Œæ²¡æœ‰è¿”å›å€¼ä¹Ÿæ— æ³•æŠ›å‡ºå¼‚å¸¸
    */</span>
    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>Callable.java</code></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@FunctionalInterface</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * è®¡ç®—ç»“æœï¼Œæˆ–åœ¨æ— æ³•è¿™æ ·åšæ—¶æŠ›å‡ºå¼‚å¸¸ã€‚
     * <span class="token keyword">@return</span> è®¡ç®—å¾—å‡ºçš„ç»“æœ
     * <span class="token keyword">@throws</span> å¦‚æœæ— æ³•è®¡ç®—ç»“æœï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸
     */</span>
    <span class="token class-name">V</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-3-2-execute-vs-submit" tabindex="-1"><a class="header-anchor" href="#_4-3-2-execute-vs-submit" aria-hidden="true">#</a> 4.3.2 <code>execute()</code> vs <code>submit()</code></h4><ul><li><code>execute()</code>æ–¹æ³•ç”¨äºæäº¤ä¸éœ€è¦è¿”å›å€¼çš„ä»»åŠ¡ï¼Œæ‰€ä»¥æ— æ³•åˆ¤æ–­ä»»åŠ¡æ˜¯å¦è¢«çº¿ç¨‹æ± æ‰§è¡ŒæˆåŠŸä¸å¦ï¼›</li><li><code>submit()</code>æ–¹æ³•ç”¨äºæäº¤éœ€è¦è¿”å›å€¼çš„ä»»åŠ¡ã€‚çº¿ç¨‹æ± ä¼šè¿”å›ä¸€ä¸ª <code>Future</code> ç±»å‹çš„å¯¹è±¡ï¼Œé€šè¿‡è¿™ä¸ª <code>Future</code> å¯¹è±¡å¯ä»¥åˆ¤æ–­ä»»åŠ¡æ˜¯å¦æ‰§è¡ŒæˆåŠŸï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ <code>Future</code> çš„ <code>get()</code>æ–¹æ³•æ¥è·å–è¿”å›å€¼ï¼Œ<code>get()</code>æ–¹æ³•ä¼šé˜»å¡å½“å‰çº¿ç¨‹ç›´åˆ°ä»»åŠ¡å®Œæˆï¼Œè€Œä½¿ç”¨ <code>getï¼ˆlong timeoutï¼ŒTimeUnit unitï¼‰</code>æ–¹æ³•çš„è¯ï¼Œå¦‚æœåœ¨ <code>timeout</code> æ—¶é—´å†…ä»»åŠ¡è¿˜æ²¡æœ‰æ‰§è¡Œå®Œï¼Œå°±ä¼šæŠ›å‡º <code>java.util.concurrent.TimeoutException</code>ã€‚</li></ul><p>è¿™é‡Œåªæ˜¯ä¸ºäº†æ¼”ç¤ºä½¿ç”¨ï¼Œæ¨èä½¿ç”¨ <code>ThreadPoolExecutor</code> æ„é€ æ–¹æ³•æ¥åˆ›å»ºçº¿ç¨‹æ± ã€‚</p><p>ç¤ºä¾‹1ï¼šä½¿ç”¨ <code>get() </code>æ–¹æ³•è·å–è¿”å›å€¼ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">ExecutorService</span> executorService <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> submit <span class="token operator">=</span> executorService<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">5000L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token string">&quot;abc&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">String</span> s <span class="token operator">=</span> submit<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
executorService<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¾“å‡ºï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>abc
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ç¤ºä¾‹2ï¼šä½¿ç”¨ <code>getï¼ˆlong timeoutï¼ŒTimeUnit unitï¼‰ </code>æ–¹æ³•è·å–è¿”å›å€¼ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">ExecutorService</span> executorService <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> submit <span class="token operator">=</span> executorService<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">5000L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token string">&quot;abc&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">String</span> s <span class="token operator">=</span> submit<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
executorService<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¾“å‡ºï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Exception in thread &quot;main&quot; java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-3-3-shutdown-vsshutdownnow" tabindex="-1"><a class="header-anchor" href="#_4-3-3-shutdown-vsshutdownnow" aria-hidden="true">#</a> 4.3.3 <code>shutdown()</code>VS<code>shutdownNow()</code></h4><ul><li><strong><code>shutdownï¼ˆï¼‰</code></strong> :å…³é—­çº¿ç¨‹æ± ï¼Œçº¿ç¨‹æ± çš„çŠ¶æ€å˜ä¸º <code>SHUTDOWN</code>ã€‚çº¿ç¨‹æ± ä¸å†æ¥å—æ–°ä»»åŠ¡äº†ï¼Œä½†æ˜¯é˜Ÿåˆ—é‡Œçš„ä»»åŠ¡å¾—æ‰§è¡Œå®Œæ¯•ã€‚</li><li><strong><code>shutdownNowï¼ˆï¼‰</code></strong> :å…³é—­çº¿ç¨‹æ± ï¼Œçº¿ç¨‹çš„çŠ¶æ€å˜ä¸º <code>STOP</code>ã€‚çº¿ç¨‹æ± ä¼šç»ˆæ­¢å½“å‰æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡ï¼Œå¹¶åœæ­¢å¤„ç†æ’é˜Ÿçš„ä»»åŠ¡å¹¶è¿”å›æ­£åœ¨ç­‰å¾…æ‰§è¡Œçš„ Listã€‚</li></ul><h4 id="_4-3-2-isterminated-vs-isshutdown" tabindex="-1"><a class="header-anchor" href="#_4-3-2-isterminated-vs-isshutdown" aria-hidden="true">#</a> 4.3.2 <code>isTerminated()</code> VS <code>isShutdown()</code></h4><ul><li><strong><code>isShutDown</code></strong> å½“è°ƒç”¨ <code>shutdown()</code> æ–¹æ³•åè¿”å›ä¸º trueã€‚</li><li><strong><code>isTerminated</code></strong> å½“è°ƒç”¨ <code>shutdown()</code> æ–¹æ³•åï¼Œå¹¶ä¸”æ‰€æœ‰æäº¤çš„ä»»åŠ¡å®Œæˆåè¿”å›ä¸º true</li></ul><h3 id="_4-4-åŠ é¤-callable-threadpoolexecutorç¤ºä¾‹ä»£ç " tabindex="-1"><a class="header-anchor" href="#_4-4-åŠ é¤-callable-threadpoolexecutorç¤ºä¾‹ä»£ç " aria-hidden="true">#</a> 4.4 åŠ é¤:<code>Callable</code>+<code>ThreadPoolExecutor</code>ç¤ºä¾‹ä»£ç </h3><p><code>MyCallable.java</code></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">Callable</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyCallable</span> <span class="token keyword">implements</span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è¿”å›æ‰§è¡Œå½“å‰ Callable çš„çº¿ç¨‹åå­—</span>
        <span class="token keyword">return</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>CallableDemo.java</code></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">ArrayBlockingQueue</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">Callable</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">ExecutionException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">Future</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">ThreadPoolExecutor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">TimeUnit</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CallableDemo</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> CORE_POOL_SIZE <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> MAX_POOL_SIZE <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> QUEUE_CAPACITY <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Long</span> KEEP_ALIVE_TIME <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">//ä½¿ç”¨é˜¿é‡Œå·´å·´æ¨èçš„åˆ›å»ºçº¿ç¨‹æ± çš„æ–¹å¼</span>
        <span class="token comment">//é€šè¿‡ThreadPoolExecutoræ„é€ å‡½æ•°è‡ªå®šä¹‰å‚æ•°åˆ›å»º</span>
        <span class="token class-name">ThreadPoolExecutor</span> executor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span>
                CORE_POOL_SIZE<span class="token punctuation">,</span>
                MAX_POOL_SIZE<span class="token punctuation">,</span>
                KEEP_ALIVE_TIME<span class="token punctuation">,</span>
                <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">ArrayBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>QUEUE_CAPACITY<span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor<span class="token punctuation">.</span>CallerRunsPolicy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Future</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> futureList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> callable <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyCallable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//æäº¤ä»»åŠ¡åˆ°çº¿ç¨‹æ± </span>
            <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> future <span class="token operator">=</span> executor<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span>callable<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//å°†è¿”å›å€¼ future æ·»åŠ åˆ° listï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ future è·å¾— æ‰§è¡Œ Callable å¾—åˆ°çš„è¿”å›å€¼</span>
            futureList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>future<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> fut <span class="token operator">:</span> futureList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;::&quot;</span> <span class="token operator">+</span> fut<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> <span class="token operator">|</span> <span class="token class-name">ExecutionException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//å…³é—­çº¿ç¨‹æ± </span>
        executor<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Output:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Wed Nov 13 13:40:41 CST 2019::pool-1-thread-1
Wed Nov 13 13:40:42 CST 2019::pool-1-thread-2
Wed Nov 13 13:40:42 CST 2019::pool-1-thread-3
Wed Nov 13 13:40:42 CST 2019::pool-1-thread-4
Wed Nov 13 13:40:42 CST 2019::pool-1-thread-5
Wed Nov 13 13:40:42 CST 2019::pool-1-thread-3
Wed Nov 13 13:40:43 CST 2019::pool-1-thread-2
Wed Nov 13 13:40:43 CST 2019::pool-1-thread-1
Wed Nov 13 13:40:43 CST 2019::pool-1-thread-4
Wed Nov 13 13:40:43 CST 2019::pool-1-thread-5
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="äº”-å‡ ç§å¸¸è§çš„çº¿ç¨‹æ± è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#äº”-å‡ ç§å¸¸è§çš„çº¿ç¨‹æ± è¯¦è§£" aria-hidden="true">#</a> äº” å‡ ç§å¸¸è§çš„çº¿ç¨‹æ± è¯¦è§£</h2><h3 id="_5-1-fixedthreadpool" tabindex="-1"><a class="header-anchor" href="#_5-1-fixedthreadpool" aria-hidden="true">#</a> 5.1 FixedThreadPool</h3><h4 id="_5-1-1-ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#_5-1-1-ä»‹ç»" aria-hidden="true">#</a> 5.1.1 ä»‹ç»</h4><p><code>FixedThreadPool</code> è¢«ç§°ä¸ºå¯é‡ç”¨å›ºå®šçº¿ç¨‹æ•°çš„çº¿ç¨‹æ± ã€‚é€šè¿‡ Executors ç±»ä¸­çš„ç›¸å…³æºä»£ç æ¥çœ‹ä¸€ä¸‹ç›¸å…³å®ç°ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>   <span class="token doc-comment comment">/**
     * åˆ›å»ºä¸€ä¸ªå¯é‡ç”¨å›ºå®šæ•°é‡çº¿ç¨‹çš„çº¿ç¨‹æ± 
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ExecutorService</span> <span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token keyword">int</span> nThreads<span class="token punctuation">,</span> <span class="token class-name">ThreadFactory</span> threadFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span>nThreads<span class="token punctuation">,</span> nThreads<span class="token punctuation">,</span>
                                      <span class="token number">0L</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">,</span>
                                      <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                      threadFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦å¤–è¿˜æœ‰ä¸€ä¸ª <code>FixedThreadPool</code> çš„å®ç°æ–¹æ³•ï¼Œå’Œä¸Šé¢çš„ç±»ä¼¼ï¼Œæ‰€ä»¥è¿™é‡Œä¸å¤šåšé˜è¿°ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ExecutorService</span> <span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token keyword">int</span> nThreads<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span>nThreads<span class="token punctuation">,</span> nThreads<span class="token punctuation">,</span>
                                      <span class="token number">0L</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">,</span>
                                      <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä»ä¸Šé¢æºä»£ç å¯ä»¥çœ‹å‡ºæ–°åˆ›å»ºçš„ <code>FixedThreadPool</code> çš„ <code>corePoolSize</code> å’Œ <code>maximumPoolSize</code> éƒ½è¢«è®¾ç½®ä¸º nThreadsï¼Œè¿™ä¸ª nThreads å‚æ•°æ˜¯æˆ‘ä»¬ä½¿ç”¨çš„æ—¶å€™è‡ªå·±ä¼ é€’çš„ã€‚</strong></p><h4 id="_5-1-2-æ‰§è¡Œä»»åŠ¡è¿‡ç¨‹ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#_5-1-2-æ‰§è¡Œä»»åŠ¡è¿‡ç¨‹ä»‹ç»" aria-hidden="true">#</a> 5.1.2 æ‰§è¡Œä»»åŠ¡è¿‡ç¨‹ä»‹ç»</h4><p><code>FixedThreadPool</code> çš„ <code>execute()</code> æ–¹æ³•è¿è¡Œç¤ºæ„å›¾ï¼ˆè¯¥å›¾ç‰‡æ¥æºï¼šã€ŠJava å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹ï¼‰ï¼š</p><p><img src="/assets/FixedThreadPool.f8172448.png" alt="FixedThreadPoolçš„execute()æ–¹æ³•è¿è¡Œç¤ºæ„å›¾" loading="lazy"></p><p><strong>ä¸Šå›¾è¯´æ˜ï¼š</strong></p><ol><li>å¦‚æœå½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°å°äº corePoolSizeï¼Œ å¦‚æœå†æ¥æ–°ä»»åŠ¡çš„è¯ï¼Œå°±åˆ›å»ºæ–°çš„çº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼›</li><li>å½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°ç­‰äº corePoolSize åï¼Œ å¦‚æœå†æ¥æ–°ä»»åŠ¡çš„è¯ï¼Œä¼šå°†ä»»åŠ¡åŠ å…¥ <code>LinkedBlockingQueue</code>ï¼›</li><li>çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ‰§è¡Œå®Œ æ‰‹å¤´çš„ä»»åŠ¡åï¼Œä¼šåœ¨å¾ªç¯ä¸­åå¤ä» <code>LinkedBlockingQueue</code> ä¸­è·å–ä»»åŠ¡æ¥æ‰§è¡Œï¼›</li></ol><h4 id="_5-1-3-ä¸ºä»€ä¹ˆä¸æ¨èä½¿ç”¨fixedthreadpool" tabindex="-1"><a class="header-anchor" href="#_5-1-3-ä¸ºä»€ä¹ˆä¸æ¨èä½¿ç”¨fixedthreadpool" aria-hidden="true">#</a> 5.1.3 ä¸ºä»€ä¹ˆä¸æ¨èä½¿ç”¨<code>FixedThreadPool</code>ï¼Ÿ</h4><p><strong><code>FixedThreadPool</code> ä½¿ç”¨æ— ç•Œé˜Ÿåˆ— <code>LinkedBlockingQueue</code>ï¼ˆé˜Ÿåˆ—çš„å®¹é‡ä¸º Integer.MAX_VALUEï¼‰ä½œä¸ºçº¿ç¨‹æ± çš„å·¥ä½œé˜Ÿåˆ—ä¼šå¯¹çº¿ç¨‹æ± å¸¦æ¥å¦‚ä¸‹å½±å“ ï¼š</strong></p><ol><li>å½“çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°è¾¾åˆ° <code>corePoolSize</code> åï¼Œæ–°ä»»åŠ¡å°†åœ¨æ— ç•Œé˜Ÿåˆ—ä¸­ç­‰å¾…ï¼Œå› æ­¤çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ä¸ä¼šè¶…è¿‡ corePoolSizeï¼›</li><li>ç”±äºä½¿ç”¨æ— ç•Œé˜Ÿåˆ—æ—¶ <code>maximumPoolSize</code> å°†æ˜¯ä¸€ä¸ªæ— æ•ˆå‚æ•°ï¼Œå› ä¸ºä¸å¯èƒ½å­˜åœ¨ä»»åŠ¡é˜Ÿåˆ—æ»¡çš„æƒ…å†µã€‚æ‰€ä»¥ï¼Œé€šè¿‡åˆ›å»º <code>FixedThreadPool</code>çš„æºç å¯ä»¥çœ‹å‡ºåˆ›å»ºçš„ <code>FixedThreadPool</code> çš„ <code>corePoolSize</code> å’Œ <code>maximumPoolSize</code> è¢«è®¾ç½®ä¸ºåŒä¸€ä¸ªå€¼ã€‚</li><li>ç”±äº 1 å’Œ 2ï¼Œä½¿ç”¨æ— ç•Œé˜Ÿåˆ—æ—¶ <code>keepAliveTime</code> å°†æ˜¯ä¸€ä¸ªæ— æ•ˆå‚æ•°ï¼›</li><li>è¿è¡Œä¸­çš„ <code>FixedThreadPool</code>ï¼ˆæœªæ‰§è¡Œ <code>shutdown()</code>æˆ– <code>shutdownNow()</code>ï¼‰ä¸ä¼šæ‹’ç»ä»»åŠ¡ï¼Œåœ¨ä»»åŠ¡æ¯”è¾ƒå¤šçš„æ—¶å€™ä¼šå¯¼è‡´ OOMï¼ˆå†…å­˜æº¢å‡ºï¼‰ã€‚</li></ol><h3 id="_5-2-singlethreadexecutor-è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#_5-2-singlethreadexecutor-è¯¦è§£" aria-hidden="true">#</a> 5.2 SingleThreadExecutor è¯¦è§£</h3><h4 id="_5-2-1-ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#_5-2-1-ä»‹ç»" aria-hidden="true">#</a> 5.2.1 ä»‹ç»</h4><p><code>SingleThreadExecutor</code> æ˜¯åªæœ‰ä¸€ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± ã€‚ä¸‹é¢çœ‹çœ‹<strong>SingleThreadExecutor çš„å®ç°ï¼š</strong></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>   <span class="token doc-comment comment">/**
     *è¿”å›åªæœ‰ä¸€ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± 
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ExecutorService</span> <span class="token function">newSingleThreadExecutor</span><span class="token punctuation">(</span><span class="token class-name">ThreadFactory</span> threadFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">FinalizableDelegatedExecutorService</span>
            <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
                                    <span class="token number">0L</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">,</span>
                                    <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                    threadFactory<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ExecutorService</span> <span class="token function">newSingleThreadExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">FinalizableDelegatedExecutorService</span>
            <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
                                    <span class="token number">0L</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">,</span>
                                    <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»ä¸Šé¢æºä»£ç å¯ä»¥çœ‹å‡ºæ–°åˆ›å»ºçš„ <code>SingleThreadExecutor</code> çš„ <code>corePoolSize</code> å’Œ <code>maximumPoolSize</code> éƒ½è¢«è®¾ç½®ä¸º 1.å…¶ä»–å‚æ•°å’Œ <code>FixedThreadPool</code> ç›¸åŒã€‚</p><h4 id="_5-2-2-æ‰§è¡Œä»»åŠ¡è¿‡ç¨‹ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#_5-2-2-æ‰§è¡Œä»»åŠ¡è¿‡ç¨‹ä»‹ç»" aria-hidden="true">#</a> 5.2.2 æ‰§è¡Œä»»åŠ¡è¿‡ç¨‹ä»‹ç»</h4><p><code>SingleThreadExecutor</code> çš„è¿è¡Œç¤ºæ„å›¾ï¼ˆè¯¥å›¾ç‰‡æ¥æºï¼šã€ŠJava å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹ï¼‰ï¼š <img src="/assets/SingleThreadExecutor.7ffd92c2.png" alt="SingleThreadExecutorçš„è¿è¡Œç¤ºæ„å›¾" loading="lazy"></p><p><strong>ä¸Šå›¾è¯´æ˜</strong> :</p><ol><li>å¦‚æœå½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°å°‘äº <code>corePoolSize</code>ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼›</li><li>å½“å‰çº¿ç¨‹æ± ä¸­æœ‰ä¸€ä¸ªè¿è¡Œçš„çº¿ç¨‹åï¼Œå°†ä»»åŠ¡åŠ å…¥ <code>LinkedBlockingQueue</code></li><li>çº¿ç¨‹æ‰§è¡Œå®Œå½“å‰çš„ä»»åŠ¡åï¼Œä¼šåœ¨å¾ªç¯ä¸­åå¤ä»<code>LinkedBlockingQueue</code> ä¸­è·å–ä»»åŠ¡æ¥æ‰§è¡Œï¼›</li></ol><h4 id="_5-2-3-ä¸ºä»€ä¹ˆä¸æ¨èä½¿ç”¨singlethreadexecutor" tabindex="-1"><a class="header-anchor" href="#_5-2-3-ä¸ºä»€ä¹ˆä¸æ¨èä½¿ç”¨singlethreadexecutor" aria-hidden="true">#</a> 5.2.3 ä¸ºä»€ä¹ˆä¸æ¨èä½¿ç”¨<code>SingleThreadExecutor</code>ï¼Ÿ</h4><p><code>SingleThreadExecutor</code> ä½¿ç”¨æ— ç•Œé˜Ÿåˆ— <code>LinkedBlockingQueue</code> ä½œä¸ºçº¿ç¨‹æ± çš„å·¥ä½œé˜Ÿåˆ—ï¼ˆé˜Ÿåˆ—çš„å®¹é‡ä¸º Intger.MAX_VALUEï¼‰ã€‚<code>SingleThreadExecutor</code> ä½¿ç”¨æ— ç•Œé˜Ÿåˆ—ä½œä¸ºçº¿ç¨‹æ± çš„å·¥ä½œé˜Ÿåˆ—ä¼šå¯¹çº¿ç¨‹æ± å¸¦æ¥çš„å½±å“ä¸ <code>FixedThreadPool</code> ç›¸åŒã€‚è¯´ç®€å•ç‚¹å°±æ˜¯å¯èƒ½ä¼šå¯¼è‡´ OOMï¼Œ</p><h3 id="_5-3-cachedthreadpool-è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#_5-3-cachedthreadpool-è¯¦è§£" aria-hidden="true">#</a> 5.3 CachedThreadPool è¯¦è§£</h3><h4 id="_5-3-1-ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#_5-3-1-ä»‹ç»" aria-hidden="true">#</a> 5.3.1 ä»‹ç»</h4><p><code>CachedThreadPool</code> æ˜¯ä¸€ä¸ªä¼šæ ¹æ®éœ€è¦åˆ›å»ºæ–°çº¿ç¨‹çš„çº¿ç¨‹æ± ã€‚ä¸‹é¢é€šè¿‡æºç æ¥çœ‹çœ‹ <code>CachedThreadPool</code> çš„å®ç°ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token doc-comment comment">/**
     * åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± ï¼Œæ ¹æ®éœ€è¦åˆ›å»ºæ–°çº¿ç¨‹ï¼Œä½†ä¼šåœ¨å…ˆå‰æ„å»ºçš„çº¿ç¨‹å¯ç”¨æ—¶é‡ç”¨å®ƒã€‚
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ExecutorService</span> <span class="token function">newCachedThreadPool</span><span class="token punctuation">(</span><span class="token class-name">ThreadFactory</span> threadFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">,</span>
                                      <span class="token number">60L</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">,</span>
                                      <span class="token keyword">new</span> <span class="token class-name">SynchronousQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                      threadFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ExecutorService</span> <span class="token function">newCachedThreadPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">,</span>
                                      <span class="token number">60L</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">,</span>
                                      <span class="token keyword">new</span> <span class="token class-name">SynchronousQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>CachedThreadPool</code> çš„<code>corePoolSize</code> è¢«è®¾ç½®ä¸ºç©ºï¼ˆ0ï¼‰ï¼Œ<code>maximumPoolSize</code>è¢«è®¾ç½®ä¸º <code>Integer.MAX.VALUE</code>ï¼Œå³å®ƒæ˜¯æ— ç•Œçš„ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€å¦‚æœä¸»çº¿ç¨‹æäº¤ä»»åŠ¡çš„é€Ÿåº¦é«˜äº <code>maximumPool</code> ä¸­çº¿ç¨‹å¤„ç†ä»»åŠ¡çš„é€Ÿåº¦æ—¶ï¼Œ<code>CachedThreadPool</code> ä¼šä¸æ–­åˆ›å»ºæ–°çš„çº¿ç¨‹ã€‚æç«¯æƒ…å†µä¸‹ï¼Œè¿™æ ·ä¼šå¯¼è‡´è€—å°½ cpu å’Œå†…å­˜èµ„æºã€‚</p><h4 id="_5-3-2-æ‰§è¡Œä»»åŠ¡è¿‡ç¨‹ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#_5-3-2-æ‰§è¡Œä»»åŠ¡è¿‡ç¨‹ä»‹ç»" aria-hidden="true">#</a> 5.3.2 æ‰§è¡Œä»»åŠ¡è¿‡ç¨‹ä»‹ç»</h4><p><code>CachedThreadPool</code> çš„ <code>execute()</code> æ–¹æ³•çš„æ‰§è¡Œç¤ºæ„å›¾ï¼ˆè¯¥å›¾ç‰‡æ¥æºï¼šã€ŠJava å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹ï¼‰ï¼š <img src="/assets/CachedThreadPool-execute.97103fbe.png" alt="CachedThreadPoolçš„execute()æ–¹æ³•çš„æ‰§è¡Œç¤ºæ„å›¾" loading="lazy"></p><p><strong>ä¸Šå›¾è¯´æ˜ï¼š</strong></p><ol><li>é¦–å…ˆæ‰§è¡Œ <code>SynchronousQueue.offer(Runnable task)</code> æäº¤ä»»åŠ¡åˆ°ä»»åŠ¡é˜Ÿåˆ—ã€‚å¦‚æœå½“å‰ <code>maximumPool</code> ä¸­æœ‰é—²çº¿ç¨‹æ­£åœ¨æ‰§è¡Œ <code>SynchronousQueue.poll(keepAliveTime,TimeUnit.NANOSECONDS)</code>ï¼Œé‚£ä¹ˆä¸»çº¿ç¨‹æ‰§è¡Œ offer æ“ä½œä¸ç©ºé—²çº¿ç¨‹æ‰§è¡Œçš„ <code>poll</code> æ“ä½œé…å¯¹æˆåŠŸï¼Œä¸»çº¿ç¨‹æŠŠä»»åŠ¡äº¤ç»™ç©ºé—²çº¿ç¨‹æ‰§è¡Œï¼Œ<code>execute()</code>æ–¹æ³•æ‰§è¡Œå®Œæˆï¼Œå¦åˆ™æ‰§è¡Œä¸‹é¢çš„æ­¥éª¤ 2ï¼›</li><li>å½“åˆå§‹ <code>maximumPool</code> ä¸ºç©ºï¼Œæˆ–è€… <code>maximumPool</code> ä¸­æ²¡æœ‰ç©ºé—²çº¿ç¨‹æ—¶ï¼Œå°†æ²¡æœ‰çº¿ç¨‹æ‰§è¡Œ <code>SynchronousQueue.poll(keepAliveTime,TimeUnit.NANOSECONDS)</code>ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæ­¥éª¤ 1 å°†å¤±è´¥ï¼Œæ­¤æ—¶ <code>CachedThreadPool</code> ä¼šåˆ›å»ºæ–°çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼Œexecute æ–¹æ³•æ‰§è¡Œå®Œæˆï¼›</li></ol><h4 id="_5-3-3-ä¸ºä»€ä¹ˆä¸æ¨èä½¿ç”¨cachedthreadpool" tabindex="-1"><a class="header-anchor" href="#_5-3-3-ä¸ºä»€ä¹ˆä¸æ¨èä½¿ç”¨cachedthreadpool" aria-hidden="true">#</a> 5.3.3 ä¸ºä»€ä¹ˆä¸æ¨èä½¿ç”¨<code>CachedThreadPool</code>ï¼Ÿ</h4><p><code>CachedThreadPool</code>å…è®¸åˆ›å»ºçš„çº¿ç¨‹æ•°é‡ä¸º <code>Integer.MAX_VALUE</code> ï¼Œå¯èƒ½ä¼šåˆ›å»ºå¤§é‡çº¿ç¨‹ï¼Œä»è€Œå¯¼è‡´ OOMã€‚</p><h2 id="å…­-scheduledthreadpoolexecutor-è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#å…­-scheduledthreadpoolexecutor-è¯¦è§£" aria-hidden="true">#</a> å…­ ScheduledThreadPoolExecutor è¯¦è§£</h2><p><strong><code>ScheduledThreadPoolExecutor</code> ä¸»è¦ç”¨æ¥åœ¨ç»™å®šçš„å»¶è¿Ÿåè¿è¡Œä»»åŠ¡ï¼Œæˆ–è€…å®šæœŸæ‰§è¡Œä»»åŠ¡ã€‚</strong> è¿™ä¸ªåœ¨å®é™…é¡¹ç›®ä¸­åŸºæœ¬ä¸ä¼šè¢«ç”¨åˆ°ï¼Œä¹Ÿä¸æ¨èä½¿ç”¨ï¼Œå¤§å®¶åªéœ€è¦ç®€å•äº†è§£ä¸€ä¸‹å®ƒçš„æ€æƒ³å³å¯ã€‚</p><h3 id="_6-1-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#_6-1-ç®€ä»‹" aria-hidden="true">#</a> 6.1 ç®€ä»‹</h3><p><code>ScheduledThreadPoolExecutor</code> ä½¿ç”¨çš„ä»»åŠ¡é˜Ÿåˆ— <code>DelayQueue</code> å°è£…äº†ä¸€ä¸ª <code>PriorityQueue</code>ï¼Œ<code>PriorityQueue</code> ä¼šå¯¹é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡è¿›è¡Œæ’åºï¼Œæ‰§è¡Œæ‰€éœ€æ—¶é—´çŸ­çš„æ”¾åœ¨å‰é¢å…ˆè¢«æ‰§è¡Œ(<code>ScheduledFutureTask</code> çš„ <code>time</code> å˜é‡å°çš„å…ˆæ‰§è¡Œ)ï¼Œå¦‚æœæ‰§è¡Œæ‰€éœ€æ—¶é—´ç›¸åŒåˆ™å…ˆæäº¤çš„ä»»åŠ¡å°†è¢«å…ˆæ‰§è¡Œ(<code>ScheduledFutureTask</code> çš„ <code>squenceNumber</code> å˜é‡å°çš„å…ˆæ‰§è¡Œ)ã€‚</p><p><strong><code>ScheduledThreadPoolExecutor</code> å’Œ <code>Timer</code> çš„æ¯”è¾ƒï¼š</strong></p><ul><li><code>Timer</code> å¯¹ç³»ç»Ÿæ—¶é’Ÿçš„å˜åŒ–æ•æ„Ÿï¼Œ<code>ScheduledThreadPoolExecutor</code>ä¸æ˜¯ï¼›</li><li><code>Timer</code> åªæœ‰ä¸€ä¸ªæ‰§è¡Œçº¿ç¨‹ï¼Œå› æ­¤é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡å¯ä»¥å»¶è¿Ÿå…¶ä»–ä»»åŠ¡ã€‚ <code>ScheduledThreadPoolExecutor</code> å¯ä»¥é…ç½®ä»»æ„æ•°é‡çš„çº¿ç¨‹ã€‚ æ­¤å¤–ï¼Œå¦‚æœä½ æƒ³ï¼ˆé€šè¿‡æä¾› ThreadFactoryï¼‰ï¼Œä½ å¯ä»¥å®Œå…¨æ§åˆ¶åˆ›å»ºçš„çº¿ç¨‹;</li><li>åœ¨<code>TimerTask</code> ä¸­æŠ›å‡ºçš„è¿è¡Œæ—¶å¼‚å¸¸ä¼šæ€æ­»ä¸€ä¸ªçº¿ç¨‹ï¼Œä»è€Œå¯¼è‡´ <code>Timer</code> æ­»æœº:-( ...å³è®¡åˆ’ä»»åŠ¡å°†ä¸å†è¿è¡Œã€‚<code>ScheduledThreadExecutor</code> ä¸ä»…æ•è·è¿è¡Œæ—¶å¼‚å¸¸ï¼Œè¿˜å…è®¸æ‚¨åœ¨éœ€è¦æ—¶å¤„ç†å®ƒä»¬ï¼ˆé€šè¿‡é‡å†™ <code>afterExecute</code> æ–¹æ³•<code>ThreadPoolExecutor</code>ï¼‰ã€‚æŠ›å‡ºå¼‚å¸¸çš„ä»»åŠ¡å°†è¢«å–æ¶ˆï¼Œä½†å…¶ä»–ä»»åŠ¡å°†ç»§ç»­è¿è¡Œã€‚</li></ul><p><strong>ç»¼ä¸Šï¼Œåœ¨ JDK1.5 ä¹‹åï¼Œä½ æ²¡æœ‰ç†ç”±å†ä½¿ç”¨ Timer è¿›è¡Œä»»åŠ¡è°ƒåº¦äº†ã€‚</strong></p><blockquote><p>å…³äºå®šæ—¶ä»»åŠ¡çš„è¯¦ç»†ä»‹ç»ï¼Œå°ä¼™ä¼´ä»¬å¯ä»¥åœ¨ JavaGuide çš„é¡¹ç›®é¦–é¡µæœç´¢â€œå®šæ—¶ä»»åŠ¡â€æ‰¾åˆ°å¯¹åº”çš„åŸåˆ›å†…å®¹ã€‚</p></blockquote><h3 id="_6-2-è¿è¡Œæœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#_6-2-è¿è¡Œæœºåˆ¶" aria-hidden="true">#</a> 6.2 è¿è¡Œæœºåˆ¶</h3><p><img src="/assets/ScheduledThreadPoolExecutoræœºåˆ¶.a7884b05.png" alt="ScheduledThreadPoolExecutorè¿è¡Œæœºåˆ¶" loading="lazy"></p><p><strong><code>ScheduledThreadPoolExecutor</code> çš„æ‰§è¡Œä¸»è¦åˆ†ä¸ºä¸¤å¤§éƒ¨åˆ†ï¼š</strong></p><ol><li>å½“è°ƒç”¨ <code>ScheduledThreadPoolExecutor</code> çš„ <strong><code>scheduleAtFixedRate()</code></strong> æ–¹æ³•æˆ–è€… <strong><code>scheduleWithFixedDelay()</code></strong> æ–¹æ³•æ—¶ï¼Œä¼šå‘ <code>ScheduledThreadPoolExecutor</code> çš„ <strong><code>DelayQueue</code></strong> æ·»åŠ ä¸€ä¸ªå®ç°äº† <strong><code>RunnableScheduledFuture</code></strong> æ¥å£çš„ <strong><code>ScheduledFutureTask</code></strong> ã€‚</li><li>çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ä» <code>DelayQueue</code> ä¸­è·å– <code>ScheduledFutureTask</code>ï¼Œç„¶åæ‰§è¡Œä»»åŠ¡ã€‚</li></ol><p><strong><code>ScheduledThreadPoolExecutor</code> ä¸ºäº†å®ç°å‘¨æœŸæ€§çš„æ‰§è¡Œä»»åŠ¡ï¼Œå¯¹ <code>ThreadPoolExecutor</code>åšäº†å¦‚ä¸‹ä¿®æ”¹ï¼š</strong></p><ul><li>ä½¿ç”¨ <strong><code>DelayQueue</code></strong> ä½œä¸ºä»»åŠ¡é˜Ÿåˆ—ï¼›</li><li>è·å–ä»»åŠ¡çš„æ–¹ä¸åŒ</li><li>æ‰§è¡Œå‘¨æœŸä»»åŠ¡åï¼Œå¢åŠ äº†é¢å¤–çš„å¤„ç†</li></ul><h3 id="_6-3-scheduledthreadpoolexecutor-æ‰§è¡Œå‘¨æœŸä»»åŠ¡çš„æ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#_6-3-scheduledthreadpoolexecutor-æ‰§è¡Œå‘¨æœŸä»»åŠ¡çš„æ­¥éª¤" aria-hidden="true">#</a> 6.3 ScheduledThreadPoolExecutor æ‰§è¡Œå‘¨æœŸä»»åŠ¡çš„æ­¥éª¤</h3><p><img src="/assets/ScheduledThreadPoolExecutoræ‰§è¡Œå‘¨æœŸä»»åŠ¡æ­¥éª¤.5bd57dd0.png" alt="ScheduledThreadPoolExecutoræ‰§è¡Œå‘¨æœŸä»»åŠ¡çš„æ­¥éª¤" loading="lazy"></p><ol><li>çº¿ç¨‹ 1 ä» <code>DelayQueue</code> ä¸­è·å–å·²åˆ°æœŸçš„ <code>ScheduledFutureTaskï¼ˆDelayQueue.take()ï¼‰</code>ã€‚åˆ°æœŸä»»åŠ¡æ˜¯æŒ‡ <code>ScheduledFutureTask</code>çš„ time å¤§äºç­‰äºå½“å‰ç³»ç»Ÿçš„æ—¶é—´ï¼›</li><li>çº¿ç¨‹ 1 æ‰§è¡Œè¿™ä¸ª <code>ScheduledFutureTask</code>ï¼›</li><li>çº¿ç¨‹ 1 ä¿®æ”¹ <code>ScheduledFutureTask</code> çš„ time å˜é‡ä¸ºä¸‹æ¬¡å°†è¦è¢«æ‰§è¡Œçš„æ—¶é—´ï¼›</li><li>çº¿ç¨‹ 1 æŠŠè¿™ä¸ªä¿®æ”¹ time ä¹‹åçš„ <code>ScheduledFutureTask</code> æ”¾å› <code>DelayQueue</code> ä¸­ï¼ˆ<code>DelayQueue.add()</code>)ã€‚</li></ol><h2 id="ä¸ƒ-çº¿ç¨‹æ± å¤§å°ç¡®å®š" tabindex="-1"><a class="header-anchor" href="#ä¸ƒ-çº¿ç¨‹æ± å¤§å°ç¡®å®š" aria-hidden="true">#</a> ä¸ƒ çº¿ç¨‹æ± å¤§å°ç¡®å®š</h2><p><strong>çº¿ç¨‹æ± æ•°é‡çš„ç¡®å®šä¸€ç›´æ˜¯å›°æ‰°ç€ç¨‹åºå‘˜çš„ä¸€ä¸ªéš¾é¢˜ï¼Œå¤§éƒ¨åˆ†ç¨‹åºå‘˜åœ¨è®¾å®šçº¿ç¨‹æ± å¤§å°çš„æ—¶å€™å°±æ˜¯éšå¿ƒè€Œå®šã€‚</strong></p><p>å¾ˆå¤šäººç”šè‡³å¯èƒ½éƒ½ä¼šè§‰å¾—æŠŠçº¿ç¨‹æ± é…ç½®è¿‡å¤§ä¸€ç‚¹æ¯”è¾ƒå¥½ï¼æˆ‘è§‰å¾—è¿™æ˜æ˜¾æ˜¯æœ‰é—®é¢˜çš„ã€‚å°±æ‹¿æˆ‘ä»¬ç”Ÿæ´»ä¸­éå¸¸å¸¸è§çš„ä¸€ä¾‹å­æ¥è¯´ï¼š<strong>å¹¶ä¸æ˜¯äººå¤šå°±èƒ½æŠŠäº‹æƒ…åšå¥½ï¼Œå¢åŠ äº†æ²Ÿé€šäº¤æµæˆæœ¬ã€‚ä½ æœ¬æ¥ä¸€ä»¶äº‹æƒ…åªéœ€è¦ 3 ä¸ªäººåšï¼Œä½ ç¡¬æ˜¯æ‹‰æ¥äº† 6 ä¸ªäººï¼Œä¼šæå‡åšäº‹æ•ˆç‡å˜›ï¼Ÿæˆ‘æƒ³å¹¶ä¸ä¼šã€‚</strong> çº¿ç¨‹æ•°é‡è¿‡å¤šçš„å½±å“ä¹Ÿæ˜¯å’Œæˆ‘ä»¬åˆ†é…å¤šå°‘äººåšäº‹æƒ…ä¸€æ ·ï¼Œå¯¹äºå¤šçº¿ç¨‹è¿™ä¸ªåœºæ™¯æ¥è¯´ä¸»è¦æ˜¯å¢åŠ äº†<strong>ä¸Šä¸‹æ–‡åˆ‡æ¢</strong>æˆæœ¬ã€‚ä¸æ¸…æ¥šä»€ä¹ˆæ˜¯ä¸Šä¸‹æ–‡åˆ‡æ¢çš„è¯ï¼Œå¯ä»¥çœ‹æˆ‘ä¸‹é¢çš„ä»‹ç»ã€‚</p><blockquote><p>ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼š</p><p>å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ä¸€èˆ¬çº¿ç¨‹çš„ä¸ªæ•°éƒ½å¤§äº CPU æ ¸å¿ƒçš„ä¸ªæ•°ï¼Œè€Œä¸€ä¸ª CPU æ ¸å¿ƒåœ¨ä»»æ„æ—¶åˆ»åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ï¼Œä¸ºäº†è®©è¿™äº›çº¿ç¨‹éƒ½èƒ½å¾—åˆ°æœ‰æ•ˆæ‰§è¡Œï¼ŒCPU é‡‡å–çš„ç­–ç•¥æ˜¯ä¸ºæ¯ä¸ªçº¿ç¨‹åˆ†é…æ—¶é—´ç‰‡å¹¶è½®è½¬çš„å½¢å¼ã€‚å½“ä¸€ä¸ªçº¿ç¨‹çš„æ—¶é—´ç‰‡ç”¨å®Œçš„æ—¶å€™å°±ä¼šé‡æ–°å¤„äºå°±ç»ªçŠ¶æ€è®©ç»™å…¶ä»–çº¿ç¨‹ä½¿ç”¨ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±å±äºä¸€æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚æ¦‚æ‹¬æ¥è¯´å°±æ˜¯ï¼šå½“å‰ä»»åŠ¡åœ¨æ‰§è¡Œå®Œ CPU æ—¶é—´ç‰‡åˆ‡æ¢åˆ°å¦ä¸€ä¸ªä»»åŠ¡ä¹‹å‰ä¼šå…ˆä¿å­˜è‡ªå·±çš„çŠ¶æ€ï¼Œä»¥ä¾¿ä¸‹æ¬¡å†åˆ‡æ¢å›è¿™ä¸ªä»»åŠ¡æ—¶ï¼Œå¯ä»¥å†åŠ è½½è¿™ä¸ªä»»åŠ¡çš„çŠ¶æ€ã€‚<strong>ä»»åŠ¡ä»ä¿å­˜åˆ°å†åŠ è½½çš„è¿‡ç¨‹å°±æ˜¯ä¸€æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢</strong>ã€‚</p><p>ä¸Šä¸‹æ–‡åˆ‡æ¢é€šå¸¸æ˜¯è®¡ç®—å¯†é›†å‹çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒéœ€è¦ç›¸å½“å¯è§‚çš„å¤„ç†å™¨æ—¶é—´ï¼Œåœ¨æ¯ç§’å‡ åä¸Šç™¾æ¬¡çš„åˆ‡æ¢ä¸­ï¼Œæ¯æ¬¡åˆ‡æ¢éƒ½éœ€è¦çº³ç§’é‡çº§çš„æ—¶é—´ã€‚æ‰€ä»¥ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢å¯¹ç³»ç»Ÿæ¥è¯´æ„å‘³ç€æ¶ˆè€—å¤§é‡çš„ CPU æ—¶é—´ï¼Œäº‹å®ä¸Šï¼Œå¯èƒ½æ˜¯æ“ä½œç³»ç»Ÿä¸­æ—¶é—´æ¶ˆè€—æœ€å¤§çš„æ“ä½œã€‚</p><p>Linux ç›¸æ¯”ä¸å…¶ä»–æ“ä½œç³»ç»Ÿï¼ˆåŒ…æ‹¬å…¶ä»–ç±» Unix ç³»ç»Ÿï¼‰æœ‰å¾ˆå¤šçš„ä¼˜ç‚¹ï¼Œå…¶ä¸­æœ‰ä¸€é¡¹å°±æ˜¯ï¼Œå…¶ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œæ¨¡å¼åˆ‡æ¢çš„æ—¶é—´æ¶ˆè€—éå¸¸å°‘ã€‚</p></blockquote><p><strong>ç±»æ¯”äºç°å®ä¸–ç•Œä¸­çš„äººç±»é€šè¿‡åˆä½œåšæŸä»¶äº‹æƒ…ï¼Œæˆ‘ä»¬å¯ä»¥è‚¯å®šçš„ä¸€ç‚¹æ˜¯çº¿ç¨‹æ± å¤§å°è®¾ç½®è¿‡å¤§æˆ–è€…è¿‡å°éƒ½ä¼šæœ‰é—®é¢˜ï¼Œåˆé€‚çš„æ‰æ˜¯æœ€å¥½ã€‚</strong></p><p><strong>å¦‚æœæˆ‘ä»¬è®¾ç½®çš„çº¿ç¨‹æ± æ•°é‡å¤ªå°çš„è¯ï¼Œå¦‚æœåŒä¸€æ—¶é—´æœ‰å¤§é‡ä»»åŠ¡/è¯·æ±‚éœ€è¦å¤„ç†ï¼Œå¯èƒ½ä¼šå¯¼è‡´å¤§é‡çš„è¯·æ±‚/ä»»åŠ¡åœ¨ä»»åŠ¡é˜Ÿåˆ—ä¸­æ’é˜Ÿç­‰å¾…æ‰§è¡Œï¼Œç”šè‡³ä¼šå‡ºç°ä»»åŠ¡é˜Ÿåˆ—æ»¡äº†ä¹‹åä»»åŠ¡/è¯·æ±‚æ— æ³•å¤„ç†çš„æƒ…å†µï¼Œæˆ–è€…å¤§é‡ä»»åŠ¡å †ç§¯åœ¨ä»»åŠ¡é˜Ÿåˆ—å¯¼è‡´ OOMã€‚è¿™æ ·å¾ˆæ˜æ˜¾æ˜¯æœ‰é—®é¢˜çš„ï¼ CPU æ ¹æœ¬æ²¡æœ‰å¾—åˆ°å……åˆ†åˆ©ç”¨ã€‚</strong></p><p><strong>ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬è®¾ç½®çº¿ç¨‹æ•°é‡å¤ªå¤§ï¼Œå¤§é‡çº¿ç¨‹å¯èƒ½ä¼šåŒæ—¶åœ¨äº‰å– CPU èµ„æºï¼Œè¿™æ ·ä¼šå¯¼è‡´å¤§é‡çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä»è€Œå¢åŠ çº¿ç¨‹çš„æ‰§è¡Œæ—¶é—´ï¼Œå½±å“äº†æ•´ä½“æ‰§è¡Œæ•ˆç‡ã€‚</strong></p><p>æœ‰ä¸€ä¸ªç®€å•å¹¶ä¸”é€‚ç”¨é¢æ¯”è¾ƒå¹¿çš„å…¬å¼ï¼š</p><ul><li><strong>CPU å¯†é›†å‹ä»»åŠ¡(N+1)ï¼š</strong> è¿™ç§ä»»åŠ¡æ¶ˆè€—çš„ä¸»è¦æ˜¯ CPU èµ„æºï¼Œå¯ä»¥å°†çº¿ç¨‹æ•°è®¾ç½®ä¸º Nï¼ˆCPU æ ¸å¿ƒæ•°ï¼‰+1ï¼Œæ¯” CPU æ ¸å¿ƒæ•°å¤šå‡ºæ¥çš„ä¸€ä¸ªçº¿ç¨‹æ˜¯ä¸ºäº†é˜²æ­¢çº¿ç¨‹å¶å‘çš„ç¼ºé¡µä¸­æ–­ï¼Œæˆ–è€…å…¶å®ƒåŸå› å¯¼è‡´çš„ä»»åŠ¡æš‚åœè€Œå¸¦æ¥çš„å½±å“ã€‚ä¸€æ—¦ä»»åŠ¡æš‚åœï¼ŒCPU å°±ä¼šå¤„äºç©ºé—²çŠ¶æ€ï¼Œè€Œåœ¨è¿™ç§æƒ…å†µä¸‹å¤šå‡ºæ¥çš„ä¸€ä¸ªçº¿ç¨‹å°±å¯ä»¥å……åˆ†åˆ©ç”¨ CPU çš„ç©ºé—²æ—¶é—´ã€‚</li><li><strong>I/O å¯†é›†å‹ä»»åŠ¡(2N)ï¼š</strong> è¿™ç§ä»»åŠ¡åº”ç”¨èµ·æ¥ï¼Œç³»ç»Ÿä¼šç”¨å¤§éƒ¨åˆ†çš„æ—¶é—´æ¥å¤„ç† I/O äº¤äº’ï¼Œè€Œçº¿ç¨‹åœ¨å¤„ç† I/O çš„æ—¶é—´æ®µå†…ä¸ä¼šå ç”¨ CPU æ¥å¤„ç†ï¼Œè¿™æ—¶å°±å¯ä»¥å°† CPU äº¤å‡ºç»™å…¶å®ƒçº¿ç¨‹ä½¿ç”¨ã€‚å› æ­¤åœ¨ I/O å¯†é›†å‹ä»»åŠ¡çš„åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¤šé…ç½®ä¸€äº›çº¿ç¨‹ï¼Œå…·ä½“çš„è®¡ç®—æ–¹æ³•æ˜¯ 2Nã€‚</li></ul><p><strong>å¦‚ä½•åˆ¤æ–­æ˜¯ CPU å¯†é›†ä»»åŠ¡è¿˜æ˜¯ IO å¯†é›†ä»»åŠ¡ï¼Ÿ</strong></p><p>CPU å¯†é›†å‹ç®€å•ç†è§£å°±æ˜¯åˆ©ç”¨ CPU è®¡ç®—èƒ½åŠ›çš„ä»»åŠ¡æ¯”å¦‚ä½ åœ¨å†…å­˜ä¸­å¯¹å¤§é‡æ•°æ®è¿›è¡Œæ’åºã€‚ä½†å‡¡æ¶‰åŠåˆ°ç½‘ç»œè¯»å–ï¼Œæ–‡ä»¶è¯»å–è¿™ç±»éƒ½æ˜¯ IO å¯†é›†å‹ï¼Œè¿™ç±»ä»»åŠ¡çš„ç‰¹ç‚¹æ˜¯ CPU è®¡ç®—è€—è´¹æ—¶é—´ç›¸æ¯”äºç­‰å¾… IO æ“ä½œå®Œæˆçš„æ—¶é—´æ¥è¯´å¾ˆå°‘ï¼Œå¤§éƒ¨åˆ†æ—¶é—´éƒ½èŠ±åœ¨äº†ç­‰å¾… IO æ“ä½œå®Œæˆä¸Šã€‚</p><h2 id="å…«-å‚è€ƒ" tabindex="-1"><a class="header-anchor" href="#å…«-å‚è€ƒ" aria-hidden="true">#</a> å…« å‚è€ƒ</h2><ul><li>ã€ŠJava å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹</li><li><a href="https://www.journaldev.com/2340/java-scheduler-scheduledexecutorservice-scheduledthreadpoolexecutor-example" title="Java Scheduler ScheduledExecutorService ScheduledThreadPoolExecutor Example" target="_blank" rel="noopener noreferrer">Java Scheduler ScheduledExecutorService ScheduledThreadPoolExecutor Example<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://examples.javacodegeeks.com/core-java/util/concurrent/scheduledthreadpoolexecutor/java-util-concurrent-scheduledthreadpoolexecutor-example/" title="java.util.concurrent.ScheduledThreadPoolExecutor Example" target="_blank" rel="noopener noreferrer">java.util.concurrent.ScheduledThreadPoolExecutor Example<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://www.journaldev.com/1069/threadpoolexecutor-java-thread-pool-example-executorservice" title="ThreadPoolExecutor â€“ Java Thread Pool Example" target="_blank" rel="noopener noreferrer">ThreadPoolExecutor â€“ Java Thread Pool Example<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h2 id="ä¹-å…¶ä»–æ¨èé˜…è¯»" tabindex="-1"><a class="header-anchor" href="#ä¹-å…¶ä»–æ¨èé˜…è¯»" aria-hidden="true">#</a> ä¹ å…¶ä»–æ¨èé˜…è¯»</h2><ul><li><a href="https://www.cnblogs.com/warehouse/p/10720781.html" title="Javaå¹¶å‘ï¼ˆä¸‰ï¼‰çº¿ç¨‹æ± åŸç†" target="_blank" rel="noopener noreferrer">Java å¹¶å‘ï¼ˆä¸‰ï¼‰çº¿ç¨‹æ± åŸç†<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://github.com/crossoverJie/JCSprout/blob/master/MD/ThreadPoolExecutor.md" title="å¦‚ä½•ä¼˜é›…çš„ä½¿ç”¨å’Œç†è§£çº¿ç¨‹æ± " target="_blank" rel="noopener noreferrer">å¦‚ä½•ä¼˜é›…çš„ä½¿ç”¨å’Œç†è§£çº¿ç¨‹æ± <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/heplex/EzfriDocs/edit/main/docs/RD/java/concurrent/java-thread-pool-summary.md" rel="noopener noreferrer" target="_blank" aria-label="ç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->ç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><span class="info">2022/12/2 21:59:58</span></div><div class="meta-item contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: zcilive@gmail.com">chun.zheng</span><!--]--><!--]--></div></footer><nav class="page-nav"><!----><a href="/RD/java/concurrent/java-thread-pool-best-practices.html" class="nav-link next" aria-label="Java çº¿ç¨‹æ± æœ€ä½³å®è·µ"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow right"></span></div><div class="link">Java çº¿ç¨‹æ± æœ€ä½³å®è·µ<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer"><a href="https://beian.miit.gov.cn/" target="_blank">æµ™ICPå¤‡2021004971å·-2</a></div><div class="copyright">Copyright Â© 2022 EzFri</div></footer><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app.55c177dd.js" defer></script>
  </body>
</html>
